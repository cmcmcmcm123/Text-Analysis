

Abstract?A pattern discovery approach applied to sequences of voltage sags is proposed for fault modeling and failure prediction. It is assumed the existence of some failures that are the result of accumulated stress produced by overcurrents during previous faults or the existence of pattern sequences produced by the reclosing of the protection system in presence of a fault. So there may exist relationships between events. Events registered in a real power distribution system are analyzed to search those fault patterns. The events considered in this study are voltage sags generated by homopolar faults and registered by power quality monitors installed in the secondary of transformers in distribution substations. The ordered list (according to their time of ocurrence) of events corresponds to a sequence, and magnitude and duration are the attributes considered to describe the events.

The aim of this work is to find patterns in a sequence of voltage sags that allow to recognize relationships between different types of sags occurred along time.

Index Terms?Homopolar faults, voltage sag, pattern discovery, sequence of events.



I. INTRODUCTION  VOLTAGE sags are consequence of power systems opera-tion (load and capacitors switching, transformer energiz- ing, etc.) and faults occurrence (phase-to-ground or phase-to- phase short-circuits). These disturbances propagating through the network affects power quality and can cause serious effects on instruments, machinery and production lines with the consequent financial losses. According to IEC, a supply voltage dip is a sudden reduction in the supply voltage to a value between 90% and 1% of the declared voltage, followed by a recovery between 10 milisecond and 1 minute later. For the IEEE a voltage drop is only a voltage sag if thereduction is between 10% and 90% of the nominal voltage.

Since the motivation of this work is to assist maintenance planning providing tools to improve predictive strategies, we focus only on those voltage sags produced by faults and failures. A power system component failure ( transformers, insulators, cables, arresters, etc.) affects directly the power continuity supply as well as the reliability of the affected component due to overcurrent and propagation of the voltage sags. So, consecutive shortcircuits in the same feeder can accelerate degradation of some components due to stress.

This work was supported by the research project ?Monitorizacio?n In- teligente de la Calidad de la Energ??a Ele?ctrica? (DPI2009-07891) funded by Ministerio de Ciencia e Innovacio?n (Spain) and FEDER. Oscar Quiroga received a PhD Grant (2010FI-B00663) funded by the Comissionat per a Universitats i Recerca del Departament d?Innovacio, Universitats i Empresa of the Generalitat de Catalunya and also the European Social Fund.

O. Quiroga, J. Mele?ndez and S. Herraiz are with the Institute of Informatics and Applications, University of Girona, Catalonia, 17071 Girona e-mails: (oscar.quiroga, joaquim.melendez, sergio.herraiz)@udg.edu.

Those effects are only visible after long periods of time. In this paper we propose the analysis of historical registers of voltage sags in order to discover possible misbehavior patterns.

Existing strategies to assess power quality of a distribution network using the historical registers of voltage sags gathered during long periods of time (one year or more) are the density tables and other statistical methods (stochastic power assessment) derived from those representations [1]. Those methods are reduced to compute the number of sags in the observation period organised in subsets, characterized by depth and duration. Those tables can be used to model a network and predict the expected number of sags in a further given period [1]. Different approaches have been proposed in the literature for measuring and predicting the severity of voltage sags in a network, assessing the compatibility of customer equipments as well as to predict future failures under a probabilistic approach [1], [2], [3]. In all those approaches sags are treated as independent events, i.e, a random process. However, other works show that this independence is not always true. This is for example the case of equipment failures caused by natural degradation [4] or ageing effect of overcurrents [5]. In [6] and [7] advanced monitoring and data recording equipment are used to document multiple failure phenomena related with gradual degradation of line devices.

In this paper, we assume the existence of those sequences of dependent events directly related with system faults and/or failures. Hence, we consider a set of successive events reg- istered in a single point of the network during a specific period of time as a sequence of events, and the aim is to find patterns in that sequence that represent evident relationships among events contained in that pattern. With that aim we use basic algorithms for episodes discovery in event sequences [8]. Those algorithms have been widely used in other fields involving data inherently organized in a sequential nature such as: alarms in a communications networks, faults report logs from an assembly line in a manufacturing plant [9], internet anomaly intrusion detection, bio-medical data analysis, stock trend prediction, etc.

The paper is organized in three additional main sections.

Next section presents those pattern discovery algorithms to be used in sequences of events and the adaptation to analyze sequences of events. Section III is focused on the results obtained when those algorithms are applied in a real data base of voltage sags gathered during three yeas in a distribution substation. Finally, the paper highlights main conclusions in section IV.

??

II. PATTERNS DISCOVERY IN SEQUENCES OF VOLTAGE SAGS  Under the consideration that several events in a sequence of events are related to each other and follow a predefined pattern we propose the use of pattern discovery algorithms to find those patterns. This idea is supported by the following assumptions:  ? Several events (voltage sags) originated in nearby points of the network can induce a failure in an aged element located in the path of the overcurrent between te trans- former and the affected point.

? The fault location is related with the magnitude of the voltage sag caused by the fault [1]. Then sags with similarities in magnitude and duration occur in nearby region of the network.

? A component failure can cause multiples voltage sags by the actuation of the protection systems according to the reclosing settings [10].

? Many faults occur in a reduced number of points or areas of the line. This happens for example with fault caused by tree/animal contacts or lighting induced events.

Therefore, the goal is to find automatically those predefined patterns in sequences of events. Multiple criteria can be considered for this purpose, for example, the frequency of apparition of those patterns.

A. Description of the Proposed Solution  In order to typify the events we use the intervals suggested in voltage sag density tables, which is a common method for presenting large repositories (or surveys) of sags gathered during long periods of time (more than one year) according to their magnitude and duration. There are several proposed tables [11], but in this work we have used the intervals of the table recommended by the standard IEC-61000-2-8 [12]. For the magnitude the events have been split in nine categories defined by the intervals: 80%-90%, 70%-80%, 60%- 70%, 50%-60%, 40%-50%, 30%-40%, 20%-30%, 10%-20% and <10%. For the duration the intervals are: <0.1s, 0.1s- 0.25s, 0.25s-0.5s, 0.5s-1s, 1s-3s, 3s-20s, 20s-60s and 60s-180s.

Then, we can have 72 different types of events (one for each cell obtained when the previous segmentation of depth and duration is combined).

B. Nomenclature: Sequences and Episodes  Two basic methods for pattern discovery in sequences were developed in [8]. Terminology and methods used in this work have been inherited from it, and are described below: Given a set E of event types, an event is a pair (A, t) where A is a type of event, A ? E, and t is its time of occurrence.

A sequence of events s can be expressed as (s, Ts, Te), where s = ?(A1, t1), (A2, t2), ..., (An, tn)?, Ai ? E for all i = 1, ..., n, ti ? ti+1 for all i = 1, ..., n ? 1, Ts is the beginning time of the sequence and Te is the ending time of the sequence, being Ts ? ti < Te for all i = 1, ..., n.

An episode is a collection of partially ordered events that occur together. The events in an episode must occur close  enough, being the user who decides how close the events must be to be considered part of an episode. This decision is made by defining a sliding time window, which is an event sequence w = (w, ts, te), where ts < Te and te > Ts, and w consists of pairs (A, t) from s, where ts ? t < te. The time span te?ts is the width of the window, win. The objective is to find within the sequences all the frequent episodes of a particular class.

There are several classes of episodes: serial episodes, when events occur strictly in that order in the sequence; parallel episodes, where the relative order of events in the sequence is not restricted, and non-serial and non-parallel episodes, which can be seen as a combination of serial and parallel episodes.

Fig. 1 shows an example of an event sequence and the different classes of episodes represented as directed acyclic graphs.

The episodes are built iteratively, starting from events and subepisodes which also must be frequent. It is defined that an episode ? is a subepisode of ? if the events of ? also belong to ? in the same partial order as ? and the events of ? are connected to all events of ? that are not in ?. An example of this type can be seen in Fig. 1.

C. Description of Methods for Episodes Discovery in Se- quences  In the first method called WINEPI [8], the frequency or support (fr) of an episode is calculated as the number or fraction of windows where the episode occurs. However, this support over-estimates the ocurrence of an episode [13].

The user must specify the minimum frequency (min fr) to consider an episode as frequent. Basic algorithm to discover frequent serial episodes developped in [8] is showed next and basically consists in that the algorithm computes the collection of frequent episodes from a defined class, in this case only serial episodes. The search starts from episodes with only one event (frequent events). Result of this first step is equivalent to density tables. Then, in each new level the algorithm computes a collection of candidate episodes, and then checks their frequency of occurrence from the event sequence. The candidate generation is based on the lemma: if an episode ? is frequent in a sequence s, then all sub-episodes ? ? ? are aso frequent. So, candidate episodes are built from the previously obtained frequent events. The structure of the WINEPI algorithm is:  Input: A set E of event types, an event sequence s over E, a class ? of episodes (serial, parallel or non-serial non-parallel), a window width win, and a frequency threshold min fr.

Output: The collection F of frequent episodes.

Method:  1) Search the set C1 of candidate episodes which have a length of 1 (only one event).

2) Initialise a counter l in 1, to count the length of the episodes.

3) Open a while rutine to evaluate the candidate episodes and find the frequent episodes until that do not have new candidate episodes.

? Make a routine to evaluate the frequency of the candidate episodes of length l.

??     Fig. 1. Event sequence and classes of episode. Note that the top of the figure show the sequence of events and in the bottom of the figure there are a example of the three classes of episode that can be found  ? Extract the frequent episodes of length l and iden- tified as Fl.

? Increase the counter l in 1 i.e make l = l + 1; ? Make a routine for generates the candidates of  length l, Cl, from the frequent episodes of length l ? 1. This collection of candidates consists of episodes such that all subepisodes are frequent.

4) For all l do output Fl; The second method, called MINEPI [8], consists in looking  at the instants of ocurrence of the episodes and the time relationships between those ocurrences instead using sliding windows and evaluate if an episode occurs in a window or not.

For each frequent episode the information about the locations of its minimal ocurrences (mo) is stored. A minimal ocurrence (mo) of an episode ? is an interval such that no proper subwindow contains the episode ? e.g., in the Fig. 1, episode ?E? has mo frecuency or support 3 (interval [5, 5], interval [35, 35]) and interval [75, 75]), while episode ?E,F ? has mo frecuency or support 2 (interval [5, 10]) and interval [35, 40]).

D. Formulation of Association Rules to Describe the Fault- Pattern  Association rules describe the connections between events in a sequence. They are obtained from frequent episodes but especifically from the frequent episodes called episodes rule [8]. An episode rule is an implication of the form ? ? ?, where ? is and subepisode of ?. The fraction fr(?)/fr(?) is the confidence of the rule (conf ), and can be interpreted as the conditional probability that the entire episode ? occurred in a window if a subepisode ? has occurred in it. For instance, if the episode ? showed in Fig. 1 is a subepisode of ?, and ? occurs in 5% of windows, i.e. fr(?) = 5%, and ? occurs in 4% of windows, i.e. fr(?) = 4%, it can be estimated that after appearing events A and B in a window, there is a possibility of 0.8 to obtain the event C in the same window.



III. MAIN RESULTS  The results obtained applying the proposed methodology are presented in this section. Here, the WINEPI method is used for frequent pattern discovery. This algorithm has the benefit of assigning a confidence index to the frequent episodes that allow to interpret them in terms of a probability of occurrence.

Fig. 2. Voltage sag density chart. Each cell represents a different type of voltage sag according to the table recommended by the standard IEC-61000- 2-8.

A. Dataset Description  Voltage sags caused by single-phase faults (homopolar faults) in the distribution system have been considered in this study. Events have been registered in the secondary of a power distribution transformers (25kV) over three years by the utility1 using a power quality monitor. A substation with a large number of events registered have been considered in the study. Fig. 2 shows the corresponding voltage sag density chart, build according to the standard IEC-61000-2-8. Fig. 2 contains a total of 527 voltage spread in columns where each cell in the figure represents a different type of event (classified according to duration and magnitude) and the height of each bar indicates the number of sags in each cell registered during the three years.

Table I exemplifies the representation of those events sorted according to the time. Each event has three main attributes: time is the occurren date of the event (timestamp); duration is the time that the voltage sags remains in the system accord- ing to the voltage sag definition; magnitude corresponds to the maximum voltage drop during the event, expressed as a percentage of the nominal voltage rms value.

B. Frequent Episodes in a Sequence of Voltage Sags  From the time, duration and magnitude of each event, we applied WINEPI algorithm to find frequent episodes under the next two principal thesis: a) actuation of reclosers in presence of a fault will produce short-time episodes associated to the reclosing settings; b)frequent shortcircuits can cause over-stress and degradation in components connected between the shorticircuit and the transformer.

1ENDESA DISTRIBUCION   ??     TABLE I EXAMPLE OF A SET OF VOLTAGE SAGS RECORDER IN THE MEASUREMENT  POINT IN A PERIOD OF SEVERAL DAYS  time duration(s) magnitude(%) 2008-06-30 21:25:55.340 0.141 55 2008-06-30 22:19:42.657 0.180 54 2008-07-01 08:25:08.062 0.362 53 2008-07-01 18:07:28.064 0.381 54 2008-07-05 07:16:57.158 0.161 40 2008-07-09 09:29:03.330 0.160 35 2008-07-09 11:39:35.637 0.141 48 2008-07-12 10:28:51.695 0.220 36 2008-07-12 10:41:07.033 0.161 61 2008-07-12 16:59:15.607 1.020 44 2008-07-17 01:35:57.562 0.701 20  TABLE II FREQUENT EPISODES WITH A WINDOW WIDTH= 45 DAYS AND A  min fr = 0.4  frequent support min. span median span max. span episodes time (days) time (days) time(days) ?42, 42? 0,47 2,90E-04 1,36 32,03 ?43, 74? 0,4 2,05 11,17 32,27  For simplicity in the test, each type of voltage sag (Fig. 2) is represented by the corresponding number of row and column in the density table (standard IEC-61000-2-8). For example, a voltage sag type 42 represents sags with a magnitude between 50% to 60%, and duration between 0.1s to 0.25s while a voltage sag type 74 represents sags with a magnitude between 20% to 30%, and duration between 0.5s to 1s.

The parameters selected for frequent episodes discovery are the following: a window width of 45 days, a minimum support min fr = 0.4 and for the association rules a minimum confidence conf = 0.5. Table II shows the frequent episodes found in the sequence after applying the WINEPI algorithm, with the support and the minimum, median and maximum span time of each episode (span time is computed as the time difference between the first and the last event of an episode).

With the parameters used, only two frequent episodes are discovered. The quantity of frequent episodes can increase if the window width is increased or the minimum support is decreased.

The span times in the table II suggest that the events in the episodes occur within intervals of a few seconds until several days. When the time span between events is very small, seconds or minutes, probably they corresponds to the same failure and ocurred by the reclosing actuation of the protection system. If the time span between events is around days, probably these events occur because of distinct faults or failures. Maximun span time between events is limited by the width of the temporal window used.

The relationships between the event types that appear in the two frequent episodes discovered in the sequence of events can have a physical meaning, i.e., that the occurrence of certain failures are the precursors of new faults, therefore if the first event in the episode occurrs will likely occur the whole episode. In this work those relations have not been verified physically in the power network.

Table II shows that the first episode is conformed by events  Fig. 3. Sequence of events corresponding to the measurement point.

The sequence are conformed by a set of events type distributed along the time according to the ocurrence date. Frequent episodes (see table II) are highlighted.

TABLE III FAULTS-PATTERN DESCRIBED BY ASSOCIATION RULES  rule confidence ? ? ?  ?42? ? ?42, 42? 0,86 ?43? ? ?43, 74? 0,63  of the same type. According to the time span, this occurred between few seconds until few days (median span time less than two days). This suggests the episode is related with faults occurred in the same or nearby region of the network (same or similar magnitude). On the other hand, the second episode is conformed by events of different type (different magnitude), i.e., the episode is related with faults occurred in different regions of the network. It may be observed that magnitude of the second event in the episode is lower (50%? 60% for the first event -type 43- and 20%? 30% for the second one -type 74-). Also, in this episode the time span between the events is longer than in the first episode. The relationship between the events in this episode can be casual, but the frequent occurrence along the sequence suggest that it is probably physical relations between the two types of events.

Fig. 3 shows the apparition of the frequent episodes (Table II) along the sequence without overlapping events. The events highlighted and linked by a dotted line belong to the same episode which occur several times during the sequence. Fig 3 also shows that the two episodes appear regularly along the sequence.

Pattern-faults are discovered from the frequent episodes by the formulation of association rules that relate episodes with subepisodes (or events). Each rule has a certain level of confidence. Table III shows the pattern episodes associated discovered for the network point analyzed.

The first fault-pattern ?42? ? ?42, 42? showed in Table III relates two sags of the same type. According to this rule, there are a probability of 0.86 that once occurred an homopolar fault whose type is 42 (Fig. 4) then a new one could occur, within a time less than 45 days in the same point or area of the   ??     Fig. 4. Sample event of a voltage sag type 42. Figure shows the behavior of the RMS voltage for all phases of the power system during the fault. Note that this voltage sag has a minimun magnitud within 50% to 60% and duration within 0.1s to 0.25s.

Fig. 5. Sample event of a voltage sag type 43. Figure shows the behavior of the RMS voltage for all phases of the power system during the fault. Note that this voltage sag has a minimun magnitud within 50% to 60% and duration within 0.25s to 0.5s.

Fig. 6. Sample event of a voltage sag type 74. Figure shows the behavior of the RMS voltage for all phases of the power system during the fault. Note that this voltage sag has a minimun magnitud within 20% to 30% and duration within 0.5s to 1s.

network.

Second fault-pattern showed in Table III relates two sags of different type ?43? ? ?43, 74?. According to this rule, there are a probability of 0.63 that once ocurred an homopolar fault whose type is 43 (Fig. 5) then a new homopolar fault of type 74 (Fig. 6) also could occur, within a time less than 45 days.

In this case the new fault might occur in other region of the network located upstream of the first fault.



IV. CONCLUSIONS  Relationships between homopolar faults in a network are found after analysing the sequence of events registered during a period of three years in a distribution substation. The magnitude an duration of the corresponding voltage sags have been used to characterize the events. The WINEPI algorithm has been used to discover frequent patterns described by episodes (sequences of events). The proposed solution shows that useful information about the behavior and evolution of the faults in the electrical system may be extracted for the recog- nition of future failures. In particular two specific behaviours described by episodes of two events have been discovered.

First one possibly corresponds to the reclosing operation due to permanent faults in the same area of the network because the short occurrence time between both events in the episode.

Last, the second pattern corresponds to faults separated in time by several days resulting in a more difficult interpretation of its physical meaning but they can give information about what may be expected if a voltage sag of this type occurr. The use of different sliding windows allows to explore fault-patterns at different time levels.

Future work should continue evaluating the behavior of other attributes in the voltage sag recorded on other points of the network and other classes of recorded events to discover fault-patterns that can be used to forecast future failures.

