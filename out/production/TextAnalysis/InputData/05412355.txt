Detecting step-stone with Network Traffic Mining Approach

Abstract   In recent years, many network users has been the serious impact by the intrusion of the Internet, there are many attack events occur at the present time. On the Internet, the intruders usually launch attacks from the stepping stone that they previously compromised. In this way, the attackers can reduce their risk of directly detected. Even if the network managers detect the invasion that still can?t identify the true attack intruders IP location through the observation records.

And there are many network attacks using a large amount of stepping stone to launch a joint flooding attack at the same time. The victim computer or web site will not bear this kind large flood traffic that make the servers cannot work properly to provide normal Internet services. The problem of stepping stone has being caused serious impact on network security.

In this study, we use the association rules mining technique to establish an automatically stepping stone detection module. By collect the connecting records in the local network to gather the information of source and destination IP addresses in the same period. The traffic data analyse by association rule algorithms trying to figure out the transmission characteristics of the stepping stone. By identifying the suspicious IP addresses of stepping stone will be helpful for the network security administrators to improve the security of network.

Keywords:  Network Security, Stepping Stone Detection, Network Attack, Data Mining   1. Introduction   With the Internet technology, the Internet existed for  many kinds of network security threats, causing a lot of serious losses. In particular, the problem of stepping stone has caused a serious security threat, the seriousness situation of the stepping stone even more than the threat of general computer viruses. In generally, attacker will use the stepping stone to hide the real location. Attackers do not use the direct access to intrude into the victim computer, that is too danger for the attacker. They use stepping stone to launch any kind network attacks. Even if the stepping stone be discovered by the network managers, they only could trace back to the stepping stone location. For the more, there are many Internet attackers will jump several stepping stones for protecting themselves, so the network administrator just can detect the stepping stone IP address that is the most near to the victim location. The subnet of the stepping stone is often not in same network area of victim?s host in. If the  administrator of victim?s network area wants to trace back to find out this is attacker address, administrator need coordination of other network manager in real time. The managers of different inter-domain network communication are often requiring strenuous effort and wasting a lot of time, that causes many stepping stone become difficulties in tracing the intrusion path. That propose internet attackers have a good chance to disguise the original location of the attacking host.

Especially in the modern Internet environment, the Internet connection is easy to be cross-regional or cross- country. The intruders who attack in the network are often using the stepping stone as transnational site. In particular, they will use the stepping stone which is not in their own countries. It?s the way to escape their country's laws and regulations. On the another hand, the host who was been attack found that the attacks of the stepping stone is in foreign countries will have to cross countries and there is no way to deal with the next step of action. In recent years, many attacks are international distributed denial-of- service attack (DDoS attack). Network attacks from different places of the world at the same time that makes the victim website managers are difficultly to prevent these kind attacks.

Intruders often search the computer that be lacking in security management in Internet, and the computer be the stepping stone after the invasion. In most of the time, this kind of the hiding stepping stone is potential and not easily to be detected. Unlike other obvious attack such as worms or replacement pages would be detected by the administrator apparently, the type of stepping stone is very flexible.

Intruder can use the stepping stone to launch various types of attacks, such as the dissemination of viruses, dictionary attacks, denial-of-service attack (DDoS attack), malicious Trojan. Intruders sometime use the special stepping stone to announce faking information on public forum that cause damage to privacy of other internet users, but there are many administrators often ignore the seriousness of these kind problems.

Our research identified the characteristic of stepping stone in the local network. Stepping stone will have high frequency of connecting record between two links, one is the connection of stepping stone to intruder's computer, the other is the connection of the victim computer to the stepping stone. It is not similar to the normal connection of internet user?s behavior. This research uses the technology of Association Rule Mining of data mining. We propose a      detecting model for identified the hiding stepping stone location base on network traffic records. If we figure out the suspected stepping stone using network traffic information that can help system manager to do more defense process before intruder made more harm. That also can help the network managers to trace back to find out the original attacking intruder?s IP address.

2. Literature Review   Most of the research of detecting stepping stone attack  focused on detection of intruder who uses stepping stone on encryption. Intruders in order to avoid detection from the contents of the packet attacks, they will use encrypted communications technology to control stepping stone. There are two types of detection method of detecting stepping stone on encrypted communications. One is Time-Based Method to classify the idle time[3], another is based on calculation of the Round Trip time (RTT) and cluster classification[4,5].

In Zhang[3] study, the Time-base method of detecting stepping stone is to use idle time to separate Network traffic.

When user type the keyboard input, network traffic will have special idle time. If the occurrences of the two connections idle time often too close or identical, it is likely the keyboard input by the user using a particular connection and then enter another transmission connection. Therefore, the method use algorithms to identify suspected of connection is stepping stone. However, this method will deliberate miscarriage at the intruders enter the command to change the idle time. It must be set the default idle time very short to increase the detection sensitivity, but also caused an increase in detection missing rate. That cause the detection system is more difficultly to detecting the stepping stone.

The study of Yang[4] provide Round Trip Time (RTT) method to detect the possibility of stepping stone for the network server. Round Trip Time refers to the time that a host from sending a packet to receive a packet. In a network connection chain, inter-host have different values of RTT because the distance between each other is different. After sending a series of consecutive packets and in accordance with the received packet time to calculate the RTT value is possible and Paints charts that can clearly to find the chain links in the network whether the existence of several host servers can respond. In the following study [5], instead of caring about the received packet should match which sent packet, letting every time of received packets minus times that sent before the received packet to get a large of RTT value. And used Maximum-minimum distance (MMD) classification to cluster and simplify the points that points' time and RTT value are similar, and then calculate the cluster rate and choice the cluster that has a higher rate. This classification method has been compared to the original RTT is more accurate results, and can use the RTT value of more than the original. Although the RTT method is more accurate way to find the connection chain in response to the computer, but it is must be calculated over a period of time all packets sent and received by the RTT. In large network area, RTT method may result in the burden of computing  loading and less performance rate of cluster result. And even if the precise use of the calculated RTT to find the number of computers on the connection chain, it cannot actually point out the possibility of host which is launching stepping stone attacks.

In using traffic pattern as the base of detection that does not to care about the packet whether it encrypt or not, and does not care about how long the idle time. There are different about using RTT information as the base of detection system. In this study do not figure the interval between send packets and receive packets, the detection system just uses the connection records in the local network.

Using association rule algorithm to identified the IP pairs that appear frequently in each division time slots. For the more, using association rule mining try to figure out the IP pairs that have higher confidence. If the two pair of IP pattern has the same IP, it represents the IP address is suspect to be the stepping stone that is control by the intruder, and the other two IP addresses one is the source of intruder and the another is the target of attacking.

3. Detection System   The Association Rule Mining is trying to find the  frequency of occurrence and identify information that may exist some potential Association Rule by using a lot of transaction data set[6]. This kind data mining technology has been widely used in many different areas of research. In this research, we use the association rules mining technology to identify possible stepping stone that are hiding in a large number of network connection records, also to help network managers to found security threats as soon as possible and take the necessary security measures. Our research proposed detection system architecture is as follows:     Figure  1 Stepping stone detection System architecture   Data Warehouse  In this study, we use the sniffing software to collect the stepping-stone and normal users? connection traffic records in the local network. After collecting these data, we aggregate a data set. This data set is using to generate the association rules, there are two important parameters, Minimal Support and Minimal Confidence, and those are the threshold value to finding the stepping-stone in this network environment. In this research, the method of data aggregating approach is as follows:      Figure  2 Transaction data set aggregate method   For each same length of time slot (Ti), there are  retrieved IP patterns (t). In the same slot of time will not repeat the same IP pattern.

Apriori Algorithm  Apriori is a good performance algorithm for Association Rule of Mining[6]. Using the method of compute the Large Item Set, it can quickly obviate the data that are not conform to the Association Rule, and can find the Association Rule which conform two conditions, Minima Support and Minima Confidence, in a short counting process. The data that be produced by Apriori which conform the conditions set and comply with the following pattern:    Figure  3 Association Rule of IP pairs   Because in our captured data, the connection of IPs with IPa and the connection of IPs with IPv often appear together, the system will detect it is a suspecting stepping stone.

4.  Experiment and Performance   In this study the source of the data was collected from the  host in the experimental environment in Kaohsiung National University. We use ssh(Secure Shell) client to connect to the host and then connect out to simulate the stepping stone for attacks, and using sniffing tool tcpdump to collect the connection records in the local network for an hour. There are totally about 19,400 connecting records in the period of our experiment.

In this study just mining the connection IP information, we only aggregate the patterns of IP pairs information to 12,290 and collecting by each  5 seconds as a time slots, there are a totally has 671 time slots and 244 IP pairs connection records. For each of the IP pairs are non- repetition. For example, a ? b and b ? a be treated as the same IP pairs records. First we use the Apriori algorithm to  calculate a single IP pairs have larger than the Minimum Support is 0.01. This means that the IP pairs in all time slots are greater than 1%.We let each other IP pairs match the other one to find out their Minimum Support larger than 0.01 at the same time, then we check the Minimum Confidence of the IP pairs records are larger than 0.4 or not.

For understand of the relation about the parameter of  Association Rule and prediction accuracy. We evaluate the different Minimum Confidence from 0.1 to 1 and Minimum Support from 0.01 to 0.04. The curve of False Alarm Rate Minimum Confidence relation is show as Figure 4.

Figure  4 False Alarm Rate of Minimum Confidence   We can find the False Alarm Rate curves are decrease as  the Minimum Confidence on different Minimum Support setting. In other words that means as the system set lower Minimum Confidence value that will cause the more suspect IP pairs are detected by the system, but that will increase the higher False Alarm Rate. In our experiment show that the Minimum Confidence setting as 0.4 maybe is a proper value, for different Minimum Support values, the False Alarm Rate are all decrease to 0. Under considering the situation of Positive Rate, we choice Minimum Support is 0.01 and Minimum Confidence is 0 .4 to set as the default value of the research experiment.

The experimental results can get 4 pairs of IP pairs to conform to the Minimum Support ? 0.01 and Minimum Confidence ? 0.4. One pair of IP Pattern is to use ssh to simulate the stepping stone for attacks. Another IP pattern is the gateway communicates with the virtual gateway through the router, that is also similar like a specially stepping stone because the virtual gateway will transform the other host package at same time.

5. Conclusion and Future Work   The stepping stone has become a serious threat of  network security. This kind of intrusion method are implicative and difficultly to detect by network managers.

Using stepping stone as an attacking tool is very flexible, intruder can use the stepping stone to launch many different various attacks. Stepping stone cause serious threat of network security but those are not easy to prevent for network administrators. In the study we propose an auto- detection mechanism base on Association Rule Mining     technology and local network connection traffic data. We hope to recognize the characteristics of transmission traffic of the stepping stone, intruder host and victim computer, to construct a detection system to find out the suspected stepping stone that are hiding in local network environment.

In this research, we use the ssh client to simulate the  stepping stone behavior. There are totally about 19,400 connect traffic data set in experimental local network environment. In the result of evaluation, we found that Minimal Confidence is an important indicator to determine the suspected stepping stone, it will have high False Alarm Rate when the value set too small. When the vale set to 0.4, the most of the suspected stepping stone can be detected.

Setting of Minimal Support must be set greater than the Support value of the ordinary connection.

In the real world, the stepping stone is not easy to obtain,  in this study only could use the traffic of the experimental local network. In the future we hope to collect more real stepping stone connection traffic data, and more different stepping stone tool for generating the different kind traffic data type for example Netflow or SNMP. That can help us to evaluate the efficiency of this research proposed model.

Wish the detection system can help network administrators to improve the security of internet.

6. Reference  [1] CERT website, "Explosion of Incidents",[Online]. Available:  http://www.cert.org/ ,2008 [2] Richard A. Kemmerer and Giovanni Vigna. ?Internet security and  intrusion detection, ? Proceedings of the 25th International Conference on Software Engineering, May 2003.

[3] Yin Zhang and Vern Paxson, "Detecting Stepping Stones," in Proceedings of the 9th USENIX Security Symposium, Denver, Colorado, USA, August 2000.

[4] Yang Jianhua, Huang Shou-Hsuan Stephen. ?A real-time algorithm to detect long connection chains of interactive terminal sessions," in (Infosecu?04), Shanghai, China; November 2004. p. 198?203.

[5] Yang Jianhua, Huang Shou-Hsuan Stephen. ?Mining TCP/IP packets on Advanced Information on Networking and Applications (AINA), 2006.

[6] R. Agrawal, T. Imielinski .and A. Swami, ?Mining association rules between sets of items in large databases, ? Proceedings of the ACM SIGMOD Conference on Management of data: 207-216, May 1993.

[7] Wanjun Yu; Xiaochun Wang; Fangyi Wang; Erkang Wang; Bowen Chen; ?The research of improved apriori algorithm for mining Communication Technology, 2008.

[8] Lei Ji; Baowen Zhang; Jianhua Li; ?A New Improvement on Apriori Algorithm, ? Computational Intelligence and Security, 2006.

