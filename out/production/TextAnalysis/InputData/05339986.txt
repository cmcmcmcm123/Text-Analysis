

?  ??????? ?? ??????????????????????? ??  ????????????? ?????????? ????? ? ????????  ?????? ? ????	?????!????? ?"??? ?#???? ?$? ???????	? ????????????????????? ??????????????????????????????????????????????? !"?  ? ????????	%??? ?? ??????? ?	???& ??  ???? ? ' ????????  ?????  ? ????(???????? ??????? ???????????????????& ???? ?? ????? " ??  ??? ???	!? )? ?????? ????????? ??? ??? ??? ? ?? ? ? ??????? ? 	???  ?????	?? ??????? ? ???? ? ???????? ??? ? ????(? ????????!?  ??? " ? ? ??????????(? '??????	? ??	????? ? ????&?? ?? ??" ?  & ?? ? ?? ??*??? ??? ??? ??? ??? ??? "??	? ????&? ? ??????? ?  &?? ?? ???? ??? ??????	!? )??????????( ? "?????????(? ??? ?  ????&?? ?? ??" ? ?  ?????? ?? ? ??? ??? ? ????? ? ???????	? ????  ? ????	???&? ? ??????? ? ???? ? ????????!? +?? ?? ??? ?? ?  ?&? ?"?????? ????? ??	????? ? ???? ???? ?? ? ??????? ?? ?????  ??&????????? ??? ?? ????? ?? ???& ?? ??? ??????(? ???? ??? ? ? ?  ?????? ? ??? ? ????? ? ?? ? ?????? ??	????? ? ???? ???!? ?? ? ?  ????? ?? ??????(? ???? ??? ? ??? ??? & ? ???? ?? ????	? ????? ?? ???  ???????????? ??? ?????? ?(????? ??	????? ? ???? ??? ? ??????????!?  ???? ???(? ?? ?? ?? ? ??????	? ?? ??????? ??? ??????(? & ?? ? ??? ?  ????&? ?&????? ?? ?????? ?????? ????????	????,???????????? ?!??? ?  ???????????" ???? ??????????? ??????????? ? ??? ???" ??????????? ?  ?????? ??? ? ????&?? !? ?? ? '? ??? ????? ? ?????? ????? ????? ??? ??  ? ?????????? ???? ????????????- ?????" ??../????& ???? " ??  ???????????	????? ????? ???!?  (?1????2????#?$?%???&???????????????'&???&?(?%??)????????'??  *????????????+?????????????,????'?????????&???*-./&??  3!? ????????????  %?? ???? ??&?? ??????&?? ???? ??	??????? ???? ,??#???? ????  ????&&???? ?0???????&? ?	? ???#?$? %???&???? ??????????  ?'&???&? (?%??)? ???? ????? &?	?#??1,?&??? ??????????????&?  ??&?,????#???????????????????&??????????	?&????&?????????????$?  ????&???????????	?????????????????&??	?&?0?????????2?????????  /???????? &???????? ?&? ??? ???&?? ??????	??????????? ???????  ???#??? ??????????????? ?	? &?????'? 	???????&?? 3??? ??4??  ????5?????? ?&? ??? ??&??????? ??#?	??? ?????????? ????,????'?  ?? ???? ?2?????????	????? &????&???????? &?????'? 	???????&? ???  ???? ?????? %?? ?????????? ,'? ?2??????? ???0??? 	?????&? ?	?  ???#??? ?2???????? &?'???? &???? ?&??????1???????? ????????&??  ???? ?????1&????? ?????????? 	????? ????5?????&? ?????? ,??  ?????5???? ?  -??$??? ??&???????? ?&? ???? ?	? ???? ????????? 	???????????  ??&$&? ??	????? ,'? ?%???? %?? ???&?&?&? ?	? ?#?? ???&?? ???$???  ???&&?	???????? ????? 	???&?&? ??? ???? ???$??? ?????? ???? ?????  ???$?????&??????????????2?????&???????'??????6?&??????		??&?  ??5??	???&????????????????????&???????	??????????????$???  ??&???????? ?&? ???? ??		?????? ???? ??? ???? ??5?&?? 	????&? ?	?  ???$?????'????&??  -?????????????????&???????????????????&??? 	???????????  ??????0??? 	?? ????? ???$??? ??&????????? ?'? ????????? ??????  ?????#????????	?????&??????????????&??????????&?????????????  ,??????????'???????	?????/??????'???????????7!8??	??????????  ???&? ???????? &???????? ??????&? ???????? ????? 7!8??	??-??  ??????&???$???,'??????????????????????&?9?":?? ?  ????? 9?;:? ?&? ?? #???1$??#?? &?	?#??? ,?&??? &?????'?  ???????????? ????????'? ??&?????? 	?? ?????#?????? ???#?$?  ????&???????????????????$?? ???????????%???? ???#????? ????  ???&???????????	????????????????????'??????????????????&???  ???????1&??????%???? %?&? ???? ????,?&?? ?&? ?&??? ???????????  ???????2??&&???&?	??????&????????????????&?&????????#???  ???&?????????????????????,?&???&?#?????&?????????&??	???????  ????5??	???????&??????????????	??????????????	???&?????????  ????,?&??? <5?? ?? ???1'??? ?5????????? ?????? ???? ????? ????  ????,?&?? ??&? ?????? ?? ????? ?????????? ???? ??? ??&? ??????'??  ????????&?5???&&??????		??????'?? ?  =???? ???? ??????	? ?&???? ???#???,?&??? ???????????&? 	??  &?????'? ?????????? ??? ????? &????? ???#?$? ??5???????&??  ?????????&?'? ??#???? ???? ????,?&?&? ??5?? ,?????? ??  &????	?????? ??????????? ??? ???#??? ????????????????  ??#???'&?????#???&???????&??????$??'????,?????????????????  &???????????#???? ?????? ?&????????&?????&??/?????#???????'?  ??5??????&?? ???? ???&?0????? &???1?		???? ?&? ????? ???#???  ??????????????&? ??? ???? ?&????1&??&???5??? =???????  ????,????? ??&???? ????????????&?? ???#??? ?&????&? ???? ,??  0???$?'??2???&????? ?  /?? ???? &???? ?????? ??? ?&??????'???&??,??? ????????%???????  ??????? ??&? ????????,?&?? ??? ???? ?????? &?? ???????#?'?????????  ?????$&? ???? ,?? ???????? ??????'??>?#?5??? ???&? ?&&??? ?&? &?????  ??????????,????? &????????#?????&???? ?&??????&? 	??2?,????&?  &?	?#??? ??????????? +???	???????? ??? ????	????,???  ???#??? ??????&? ??????????? ???? ???????? ?	? ??????&?? %??  ?????????????'?????&?????????????&?????????&?????????&??????  ??? &?	?#??? ??????????????&???&??,?? ??$??? ????????????? ?????  ???#???????????????????&?????&?&??????????'??	??1???	??1????  ??????#?????&?????????  3???	???? ??? #????? ,?? ?????? ?	? ?? ?%??? ?????? ,??  ???????????? ??? ?? ?????#?????? ??????? &?? ????? ???? &????????  ????,?&?? ??????? ???????&? ?????????'? &????? ??? ?????&?&?  ??	??????'?? *????????? ???? ??????? ????????? &?????? ,?? ?????  ??? ???? ????? ???? ???????? #????? ??????&? ????? ??????? ??#?  &???????&? &?????? ???? ????? ??? &????	?????? ??????????? ????  ?????????		??&?? ?  ?%??? &???????&? ???? 5?'? 	??? ,????? ?&? &?????? ?&?  ????$???? ???? 5????? ?	? ?? ?????? 	????? ??? ?&? ??????2? ?&?  ???????????? ???? &????&?????? ????????&???&? ?	? ?? ??????????? ??  ??????????? &????&???????? ???????? ????'&?&?? &&???????'?  &???????&? ???&???? ???? ????5????&? ??? ??????? ??&? ??? ??	???  ??? ????? ????&&? ????? ?? ???????? &'&????? 3??&?? ????5????&? ????  ???????? &???? ?????&? ?&? ?????????? ?????&?? ??????? &????&??  0??'???? ????,?&?&? ???? 	????#???? ???? &???&? ?	? ?? ?????????  /???5????&? &???? ?&? ???&?? ???? ,?? ,?$??? ??#?? ????? ?? &??? ?	?  ????????&?? ???? &???????&? ??&??,?? &?0?????&? ?	? ???&??  ????????&?? ?  ?????? ??????&? ??&?? ????	???? ??????? ????????? ?????  ?????????&?0?????&?&??????,????????&?0?????&??????????????     ?  ???? ???????? %?? ????????? ,?&??? ?????? &?0?????&? ??? ?????????  ??	????????	??????&????	?????#?,???????5????&??/?'?&????&????????  ?????? &?0?????? ??????,????&?&&??,???? ???,?&??? &?0?????&?? %	?  ??? ?????? &?0?????? ?????? ,?? ??????? ??? ?? &????????? ?? ,?&???  &?0?????? ?????? ,?? ??????? ??? ?? ????'? ???????? >?????? ???  ????????#??????????&????????????,?&????#&?????????,???	?  ????'? ??????&? #????? ???&???? 	??????????? ????????&? ?&?  ????????? ?  3??&??,&?5????????????&???????????????????,???	?????'?  ??????&? ?&? ???????? ?	? ????? ????'? ??????? ???&????&? ??? ???  ?????????? %	?#?????????&???? ????&???????&??&???????????&?  ?	????&??????'???????&?? ????????'??????#????&????&?  ?0????????????????@??????????'???????&?????????????????  &????????????,?&??????,??&????	??????'?????????  ?'? ????'@???? &???????? ??????? &??&? ?2??????? 	??? ??  ?????????,?&???#??5??	???????&???????????&?#???,&?5????????  ???'? ????'? ??????&? ?????? ????????'? #?????? &???????&??   5???#???? ??#? &???????&? ??? ??????????'? ?	? ????? ???? ,??  ???????&??? ????? ???? ?2?&????? &??? ?	? ????'? ??????&?? #????  ??	?0????? ????????&?? -????????'?? ???&? ??????&? ????? ?? &??????  ??????? ?	? ????'? ?? ????? ???#??? ?&????&? ?????? ,??  ?0?????????????????????&??????'???????&?? ?  ?????? ???? ??????&? ??? ??&??????? 	??? ???#?$? ??		???  ??'???? ????? 	?? ??????? ???????&? ???? &?5???&?? ??? ?&?  ??&???,??? ??? ,????5?? ????? ???&? ?,&?5?????? ?&? ???? ???'?  ???????,??? ??? ???? ??????? &??? ?,&??????? 	??? ???? ????? ????  ????,?&?? ????? #?? &???????? ,??? ??&?? ???????,??? ??? ??????? &??&?  ?????????????????????,?&??????#?$? %???&??????????????  ?'&???&?(?%??&)??&?#?????3?????????????????????	?&????????  ???????&??&???'?,????		??????????????5?&????5???????&??????  ????'????????&??&?&??????,??&???????  3??? ???????? ?	? ???&? ????? ?&? ?????@??? ?&? 	????#&A?  ???????? "? ,??	?'? ????????&? ??????? #?$? ????? ?&? ???&??'?  ??????????????		??????????????????&????&?????,&?5??????????  ??&???&? ?? ?#?? &???? ???????? ??? ???????&?? ???? ?????  &???????????? ????,?&??? ???????? B? 5??	??&? ??? ?,&?5??????  ??????? ????????? ????'&?&?? ???????? C? ??&??&&?&? &???? ,?&???  ????????&? ?	? ??? ?????? ???????? #?$? ,?&??? ??? ????  ???????&??? ????? &???????&?? ???????? D? &?????@?&? ???&?  ??????  4!? ? ??? ??1??,?  3??????,?&???	????$??#??????????#?&?*??$???????????#???  ?&?? ?????????? ????????????? ??????&? 	??? ???? ????? ????  ????,?&?? ??? ???? ?	? ????	????,??? ???#??? 9 :?? ?????? ????  ????'? 	???&? #?&? ??? ???#??? ???????????? ???'? ?????  ????????? ?&&??&? #??? ????,?????'? ???? ???&?????? ??? ???&?  ??&????? *??? ???? ??&?????5?? ?	? ??????? ?????????  ??????????????????????????????#?&?????????#?????????&?????  ,?????????????????????????????????????&???????,????&&???&?????  ??????&????????	??????>?#?5??????&???????????'E&??????'?  ?5??5???? ???#?$? &?????'? ?0???????&?? ???&? ????????? ?&? ???  ?????? 	??&?,???? ??????'?? &???????? ??????? ????????? ?&?  ??????? ??????????????? ?????????????	???'?&???????1??????????  ,?&??? ?%???? /&? ??? ????	????,??? ???#??? ???????????&??  ??????????????&??????	??????????????????????&??	?????????&??  ????????'??		???&? ?????		??????'??	? ???&?????????????&??3???? ?&?  5?'?????????	????????????????????????&???	????????	???????  ??????????? /???????? ???'? ?????????? ???? &????,????'? ?&&??&? ?	?  ??????&????? ??? ??????#????&?@???	?????? ????????,?&??? ???'?  ????????????&????'????????	???&???????&??  ??? ??? ??#?? ??&???? ????5?????&? ,?&??? ??? ?? 5????'? ?	?  ??????0??&? ??5?? ,???? ???????? ??? ???#??1,?&??? ???????  ?????????????????&??>?#?5??? ???'???5?????????'?&?		????  ??? ???????? ???#??? ?&????&?? ?&???????'? ???? ?????? ,??????  ?	? ????'? ?&????&? ??? &???? ??????&? ?? ??	??? ???????  ??????&????  ???????????9D:?????&??????????5??????&????,????'??&&????	?  ?????????????&??????????????5????????	???????,'??&????  71??1?? ??????&? 	?? ????? ,'??? ????????? ???? ??&???????????  ???? ??????? ??????? 	?? ???? ???? &???? ???????? 3??? 71??1??  ???????#?&?&?????????????????????????????????	?&??&??????	?  ???? ?????????? ??	??? ??????????? ?? ??????&???? ?????? ????? ???  ???? ???????? ??5??? ?&? ???????? ??? ?? &?????? ,??? ??5??F? ????  ??????&??&???????????	?????,?&?????????&??&??????,??&???'?  ???&?????&?????'?????????????5?????&?@???	?????????????&????  ???1???????? %?? ??????? ??&????? ???????? ???? ???,?? ?	? 	??1???  ??&?? ?????&? ???? &???? ?		???? ??? ?????? ???????'?? ???? ????  ????????&? ?&?? ???? &????????? ?????? ???????'???????&? ???  ?2????'?????&?????%?&???????????????	??&??????&?5?&????#???  ?&????&?? 3?? ?????5?? ???? ?		??????? ?????????? ??????&? ???  ??5????? ????? ??	?2? ???? &?		?2? ????? ???? ???? ??	?2? ???? #?&?  ?&??? ??? ????2? ??4?? ??????? ?	? ??????&? ?????????? ??? &?		?2?  ?????=????? ???? ??	?2? ????#?&? $???? ??? ?????? ???? &?		?2? ????  #?&? $???? ??? ?		1????? 6<+?? %?? #?&? ?,5???&? ????? ???? &?@?? ?	?  ??1????? 6/+? ???? ???? ,???#????? ??1,??#???? ??????&?  ?????'????????????&'&??????	????????  3???? ??? ??????? ?		??&? ????? 	???&? ??? ????  ????????????????	????????2??&&???????????????????????????  9B:?? 9?B:?? ?????	?????'?? ,'? ?&???? ???????????&???? *??????  /????????(?*/)????&??????	????????@???????????????????????  ???'??????'????????6G??D????????9;:?????????'???&???2??????  ??????? ??????? ??	?2? &?????? ??????0??&?? .????  ?2?????????? ?&???&? #??? ?????5???? ??????????? C!!? %???  ?????? ?2??&&???&? 	???????? ??? "CH? ?????? ????&??>?#?5???  ????&????,????'??&&???#?????,???????????#????????????,?&?  ?	??2??&&???&?,?????????????????? ?  /??#?????????????5????????????	????,???&??????????????  ?????????? ??? &???????? ????????????$??? ??&???????? 9?:??3??'?  ?2??????? &?	?#??? ??? ?? ??????? ????&?? ????&&?? 	?? *??????  ??????+??????? (*?+)??????????#???? ???? &???????	? &???????  6/+??3???&?	?#??????????&???*?+?	?????????&??2???????  ??? ???? ????? ???? ????,?&??? ???? ???? *?+? ?&? ??? ?????? ?	?  ??????????????????????????>?#?5???,??????????????????????  ????????? ?	? ???? *?+? 	?? ??????? ????????? #????? ,??????  ???? ???????????? ?&? ???? ???,?? ?	? ??????&? ?????&?&?? %??  ?????????? ????????? ???'? ????? ??? ?????&?? ?????????? ,'?  ?????&???? ??1?????6/+?,???#?????? ????? ?&? ?? ?????? ??? ??#?  ?????,???#?????????,???????&????  %?&??????	??????????'?	???&????????????????????&???	??  ??	???????????5????????&?????&???5????&??????&??????  ????5????	???????,'???$??????5????????	?&???????????&?  ??? ???#?$? ??		??? 9??:?? 9":?? 3??'? ?????????? ????? ????????&?  ???$??&? ??$?? ??? ???'? ?? &????? &???? ?	? ?????? ??		????  360 2009 7th International Workshop on the Design of Reliable Communication Networks    Consequently, they adopted hybrid architectures in which hardware devices handle pre-filtering and PC-based software implements Snort for final identification. It was reported that more than 90% of the workload of traffic processing could be relieved from Snort software through this approach. In addition, this design could sustain more than 10Gbps throughput compared to 1Gbps Snort throughput. Compared with the other approaches, this approach is more flexible and has good scalability. However, the problem of maintaining 1Gbps throughput of software-based Snort is not trivial.

Another approach [3] that is close to our effort attracts our attention due to its good performance on both feasibility and scalability achieved by partitioning Snort patterns. While many hardware-based pattern matching applications focus more on hardware innovation, their investigation focused more deeply into the original pattern sets. The graph-based ?min-cut? technique [10] was applied to help achieve optimal design. The basic idea of min-cut partition is that the number of edges between nodes within the group is maximized, and the number of edges between different groups is minimized.

After partitioning, optimized pattern structures are implemented in hardware for pattern matching operation. In fact, this is the only work we know of that focuses on the analysis of relationships concealed in Snort patterns to improve the performance of the corresponding hardware processing and to solve scalability issues.

3. Decomposition of SNORT Patterns Most efforts to improve the performance of  hardware-based pattern matching implementations have focused on the innovation of hardware architectures or matching algorithms. However, the original source of the complexity and scalability problems are the characteristics of the signature pattern set. Therefore, it is more effective to gain a deeper insight into these characteristics before investigating hardware architectures.

Our study has revealed that the most significant factor causing Snort signature pattern set inflation is the existence of internal redundancies. If these concealed redundancies can be successfully reduced the size of signature pattern set can be well controlled, so as to relieve the complexity and scalability issues of subsequent implementations. This section introduces a two-step signature pattern decomposition method developed for this purpose.

3.1 Redundancies in SNORT Patterns Sets The signature patterns used in this work are extracted  from the Snort rule database. In addition to these patterns, other packet information is also contained in the database for detection and administrative support such as source/ destination addresses, source/destination ports, protocols, flags and tags. In general, a complete Snort rule consists of two logic sections, the rule header and the rule options [17].

Figure 1 shows a Snort signature selected from its database. The text up to the first parenthesis is the rule header portion, which includes basic packet header information with specific IP addresses replaced by wildcards. The second  portion within the parentheses is the rule options, which includes alert messages, pre-identified signature patterns, and other support information for Snort NIDS.

Figure 1. An example of a Snort rule.

Within the rule, the data string being quoted after the ?content? is the signature pattern that is sought. ?Content? works as a keyword in the Snort rules database, introducing the specific signature patterns for deep packet inspection [17].

An example of such a signature pattern is shown in Figure 2.

In this case, the pattern is composed of both text characters and binary data. The binary data is represented in hex format and enclosed within pipe characters (|).

Figure 2. A Sample of Snort signature pattern  For convenience, we take a group of signature patterns extracted from the Snort rule database as an example to study its properties. We call such a group of signature patterns a signature pattern set. There are two important properties that exist in a signature pattern set: repetition and composition.

1. Repetition: as shown in Figure 3, signature patterns contained in 3 rules out of total 6 are the same. This   Figure 3 Repetition of patterns   Figure 4 Composition of primary patterns  2009 7th International Workshop on the Design of Reliable Communication Networks 361    ?  ????????'? ??????&? ????? ?????&???? ???? ???,?? ?	?  &???????&? ??'? ???? ????&&???'? ????? ??? ??  ??????&????? ?????&?? ??? ???? ???,?? ?	? ????'?  ??????&??  "?? ???????????2? ?&? &??#?? ??? *????? B?? ????? &????????  ????,?????&???????&??????,?????????	?&?????????????  ??????&?? ?? ????'? ??????&?? 3??&?? ?? &????????  ???????????,?????????&??????????????????????'?  ??????&??   &&???????'?? ???? ?2?&?????? ?	? ,???? ?????????? ????  ?????&?????? ????'? ????? ??????????&? ?2?&?? ??? ??????????? &????  %?&????? ?	? ??&&???? ???&?? ??????????&? ??? ???&????????  ???#??? ????????&? ?? ????'???? ???? &????&????????  ???????&?&?	??????????'??????????????????????#?????&????  ??5???? ?&????'???????????????&????? ??? ?&??????		????5?? ???  ???5?? ???&?? ??????????&? ??? 	???? ??? ???? ????? #???? ????  ???????&????&???????????  <????#?????	???'???????		????&????????????&?????????'??&?  ??????????2??'??	????????&???????????#?????&????????????  ,??? ??&?? ???? &????,????'? ?	? ???? &'&???? ?&? ????5????3?????#??  ???? ????????? ???? &???? 	???????????'? ?&? ???? ???????? ??&????  #???? 	?#?? ??????&? ???????????? ??? ???? ??????&??<,5???&?'??  ???&? ???????? ????5?&? ???? ???	????? ,??#???? ???? ??#????  &????????????,?&?&????????????????#???&???????&????&??  5!4? 6??? ???? ???????????  ??&??? ??? ???? ?,?5?? ?,&?5?????&?? #?? ???????&?? ????  ?,&??????? ??????? &??? 	????? ??? ???5?? ??????????&?? 3???  ???????&?????? ???&?&?&? ?	? ?#?? &???&? ???&???????? ??? ????  ???????&? ?	? ?????????? ???? ?????&??????? 3??? 	?&?? &?????  ????????#????????????????????????????&?????&?&??????	?#????%??  ????$&????? ????5?????? &??????????????&? ??&???? ??????????? &???  ???????????&????'????5?&???????????????&??3???&??????&?????  ????????? ?????&??????? ??5??5?&? 	????? ???????&????  &??????????????&??????????'???????&??/?????'?????????&???  &?,&????? ?	? ?? &???????? ???????? 3??&? &???? ?&? ???? ??		??????  &????? ????? ??? ???'? #?'&? ???? ???? ??&?? ???? ???????&??  ????5??????&??????????????&??????????'???????&??  3??? ??&?? ???????????? ?&&??? ??? ???? &?????? &???? ?	? ?????  ???????&?????? ?&? ,????????? ???? ?????		&? ,??#???? &'&????  ??	??????? ???? ????????'?? ????????? ??????&? ???? ,??  ???????&????????????'???????&??	?5????&???????&?????????  ??? &?????? ???????&? ??? ??? ?????? &???????? ??????&?? %?? ?&?  ??I5?? ???? ???		??????? ??? ???????&?? ???? &???????? ??????&?  ??#?? ??? ???? ???????? ??5???? /???????? ???? ?????? ???,?? ?	?  ???????&? ?&???? ???? ?????? ???? ???,?? ?	? ????'? ??????&??  #??????5???2????????????,???	?/??%%?????&?("CD??#?????5???  ?#???&??? ??????????? 9?:)?? &???? 	???1??????????????&??????  ????&? ??? ????????&? ?5?????? ??? &'&???? ??	??????? #?????  ??	?????? ?'?????? ??????? ????????? &????? ??? ?&? ?2?????'?  ???		??????? ??? ????&????? &???????? ??????&? 	??? ????5??????  ???????&??  =????????????????????????&???????????2?1,?&?????????&?  ??? ???? J#??K? ??5???? #????? ??$?&? ??5??????? ?	? ??2?1,?&???  ??????????&??2??,????????&????????&??&??&?????&????&??&??#??  ??? *???? B?? /???????? ??????? ???????&?????? ?????? ??&?? ,??  ??	????????,???'????????????&??&?????&????&??&??#?????*????  ??? ??????&? ?	? ???????????? ????'? ??????&? ??? ???? ?&?  ??????????'??,5???&???????????????'?????? ?&? ???5??	'? ????  ???????&&? ???? 	??&?,????'? ?	? ???? ????&??? ????????? ???&?  ????????'? ????'&?&? ?	? ???????&?????? ,??&??? ??? ??2??  ???????????????&??&?????????  *?? ???????&??????? #?? ??5?? ???&??? ???? 	????#????  ????&????? /? &????? ?	? ??4?????? ???????&? ???? ??????????? ??'?  J?'?????&'?,??K?,??#??????'??#?????????&??&????&???????&?  ??????'??????????&???? ?????'?????&'?,??&?,'? ????&??5?&??  3?$???? ???? &??????????????&? ???*????B? 	???2??????? J????K??  J??? ?K??J ????K??????J??????K???????????&???????&?????'?  ??????&?????JLK?????J?K???????&???????&?J?'?????&'?,??&K??  %????????????'?&'?,??????,??#?????#??????????&????&???????  ,?? ???&?????? ?&? J?'????? &'?,??KF? #?? ??5?? ???&???  ????&????(MLE)???'?????(M1M)????????(M?E)?????&?????(M?M)?????  ?#??? &??&?? (M?E)? ???????&? ??? ,?? ?'????? &'?,??&??  ?????	?????'?? ??? ??&?&? #???? ??????&? 	??? ???,???????&? ?	?  ,??????2?????????&?????,???'?????????'?,???'??????&????????  ,??#???? ???&? ?	? JNK? ?&? ???&?????? ?&? ??? ????5?????? ????'?  ???????????&?????????????????&????*??????	???2???????JNC?NK??  J-%- K?? JNC?? !!? !C? !!? !?NK? ??? ???? ???&?????? ?&? ????'?  ??????&??%??#????????????????JNK???&??	??&????????????	???????&?  ??? ????????? %?&?????? ??? ?&? ?&??? ???'? ?&? ????$? ??? ??&??????&??  ,??#??????2?????????&?????,???'???????  *????? C? &??#&? ???? ??????? ??? ???? ???,?? ?	? ???????  ???????&? ?&??????? 	??? ???? ?#?1&???? &???????? ???????  ???????&????????????? 	?? 5????&? ????????&? ?	? ????? ???&??  #????? *???? D? &??#&? ???? ??????? ??? ?????? &?????? &?@??? 3???  &???????? ??????& ? ??? ??$??? 	??? ????? O?"????? ???? ???  ??5????? ?????B7? ????????&??3??????????? ?? ????? 5??#?????????  ????????&????????????????&&??????C!????????&?????2???????	???  *????C????????&?????????????????&&??????C!!????????&??????????  ?2??????? 	??? *???? D?? 3??? ????????? 	????&? ??? ????????? ???  ??? ?????????? ????? 9?7:?? =?????? ????? ??????'?? ???? ????&?  &??#????????????????,???	?&???????????????&?5????&?(,?	???  ?#?1&???? ????&&???)?? ???? ???,?? ?	??? ????????'? ???5???  ???? ???? ???,?? ?	? ????'? ??????&? ?	??? &?,&?0????? ?????  ???????&???????3???????????????????????#?????????????????'??  ????? ????? ???? 5???????&? ?????? ?????? ???? 5????&? ??5?? ,????  ??????@????????????????????????(*????C)???&?@??(*????D)??	?????  ???????&???????&??????????????'??3???????????5?????????????  ??????????@??????? ????? ?&???#????5???????? ??? ???????,???	?  &???????? ??????&? ???? ???? ?????? &?@?? ?	? ???? ????5??????  ????????&??3?????????&????????'?????????	???????5???&?????  ??????@????&????	??????????????&????,?????? ?  *?? ????'? ?5?'? &???????? ??????? ??????'? ??? *???? C??  ????? ?&? ?? &????	?????? ????????? ??? ???? ???,?? ?	? &????????  ??????&??	???????????'????5????#?????&????&?????????????  ?	? ??&?? ?	? ?????? &???????? ??????? ???????&?? <??? ?	? ????  ?2???????&?&????*????C??&??????????????????????'??	??#?????  ???????????? ???,???	? &???????? ???????&? ("!?!7;)? ?&? ???????  ??? ?B7? ?	??? ?????????? ???5???? 3????? ??? ???? ????	?????  ????&??&???5????????#?&??????????'??	????????????????????&??  3???????????5???&???&? 	?????????????????&???&??#?????? ?????  ????????????	?"C?7!"?&??????????????????????&????????????,?&???  ???'?B!;D???????0????>?#?5??????????,???????&?&?????DB?  ???????&? ???? ??CC? ,'??&? ?	??? ????? ??????? ???????&???????  362 2009 7th International Workshop on the Design of Reliable Communication Networks    ?  ?&?????5??'??%??*????D??????,&?5?&????????&?????&?@?????? ???  ?????????? ???5??? ????? ?&? ,?&??? ??? ???? ??????? ?	? ??&?? ????  &?@?? ?	? ???? ??????&?? 3??? ????????? ????????? ??? &?@?? 	?? ????  ???????????????&??&?	????BC??B7?,'??&???#?????;"???C?,'??&??  ????????????	?4?&???5??C!8??  /	??? &?,&?0????? ????? ???????&??????? ???? ??????? ?????'?  ?????? ???&???&? ???? ???,?? ?	? ???0??? ????'? ??????&?  ??&???F? ???&?? ???? #????? ?2????? ???? ?????? ??? ?????&?? &?????  ????? ??????? ?&? ,?$??? ??#?? ????? &?,&????&? ????? &????? ?????  ??????? ?&? ??&??	? ???0???? ????#????? ?2????? ????? ??? ?????,????  &????????? ??#? ??? ???? ??????? %?? ???? ??&?? ?	? ???? ?? ??? ????  ????	?? ????????&?? ????? ?&? ?? ?????&?? ??? ???? ???,?? ?	?  ??????? ???????&?? 3??&? &????&?&? ???? &???????? ??????&? ???  ?????	?????????????&??	???&??????&????	?????'???????&??   5??? ???? ????????? ????? ?????'? ?????? ?&? ???? &?@?? ?	? ????  ?&???????????'????????&???(?"?7 7?,'??&)??#????????&???&?  ??	??????????&???	?CC8??	????????????????5?????&??????????  ?? ?????? ?????&?? ?	? ?5?? ;;8? 	?? ???? ?#?? &???? ????&&????  ??????????????@??????????&?@?&?  7!?8???? ??)???(????????9 ??????????  3??? 	??????????? ????5?????? ?	? ????? ???????&?????? ?&?  ????? &???????? ??????&? ??? ????????? ??? ????5????&? ????? ???  ?????????&???????	??????????????????????&&??????????????  &'&?????/??????5??'???'????&?&???	?????????????????????????&?  ????? ??? ??????? ??? ??????? ????'? ??????&? ?????????? ??? ??  &???????? ???????? ?????????? ??? ???? &?5???? ,????? ?????$????  ???? ????5????&? ?	? ??? ??????? ??'? ?2??,??? ?? #???? ????? ?	?  ??5?&?? ????? 	????&? ?????? 	?????????????&F? '??? 	?? ?????  &?5????????????????????????&?&??????,????????????????????????  ???? &??? ?	? ????????&? (?????&)? ????? ??? ??????@??? ,'? ????  ???????? &?	?#??? ????????????? ???? &?5????? 3??&? &??? ?&?  ????? ????????,'? ????????5????&? ?????#????,???	??? ?????????$???  ?????? ???????,???	?&?5???&? ?????????????????????????????  ?&??2??????? ???,??	??????? ???? ?????????,???	?????'???????&?  &???????????2???????	???????????,??????/	???????????&????  ????????? &?@??? ???? ???,?? ?	? ????'? ??????&? ?&? ????$??'? ???  ?????&?? &????	??????'? #???? ??????????? ?????&?&? ??? ????  ???,???	?&??????????????&????????????,?&??? ?  /&&?????? ????? ??? ?&? 	??&?,??? ??? ????&????? &????????  ??????&? 	??? ?? ???????? ???,?? ?	? ????'? ??????&?? ???? ????  ?&???? &?????? ,?? &??????? ???? ?		??????? ???#???  ??????????????&??=?? ???&???? ?&&??&? ??????? ??? ??????&????  &??????????????&????&???????B????3??5??	'?????????&???????????  ???,?? ?	? ????'? ??????&? ?&? ,??????? ??? ???????? ???? ?????  ???&?,??????&?????,?&??????&????????????,?&??&?@???#??????'@??  ?????????????????#??????????'???????&????&???????B?"?? ?  7!3???	????? ?6??? ???? ???????????  3?? ,???	??? 	??? ???? ??????? &?@?? ?	? ???? ????'? ???????  &???? ??? ?&? ???????? ??? 	???? ??? ?		??????? ???????? ??? ?2??&&? ????  ????&????? ???? ???????? &???????? ??????&? 	??? ????'?  ??????&???????????????????????5?????????????	?????,??#????  ??????#????&?@???	?&????????????,?&?&????????????????#???  ?&????&?? &????? ??#?'? ?????? &???????? ??????&? ???? ,??  ???????&??? ??? ???? ????&??????? 	??? ?2?&????? ????'?  ??????&?? %?? ??????? #??&?? ???? ??????????????? ?????5?&?  &????,????'?#?????&???????????????,???	?&??????????????&?? ? ???????????????????&???????0????????????'?&?????  ??? &???? ??#? ??????&? 9 :?? 9B:?? 9?B:?? 9?:?? ??? ??5??? ????????  ??&???????????????????????5???????,?????&????,????'??????????  ???????????&???????0??????????2???&??	???????&?	?????????  ??????&????97:??9?C:??????????????&??????&??????????????  ??&?,???	????1,????????????????? ?  3??? ??,???? ?	? ?		???????'? ????&???????? &????????  ??????&?,?&??????????'???????&??&???????	???????#?1&????  ???????&?????? ???????? ?&? ??? ???? ?	? 	????? ?&??????  ???&??????? ????? ????'? ??????? ?&? ?? &?????? ????? ??????  ????&???????? ?? &???????? ??????? ?&? &????'? ?? ????&&? ?	?  ?????????????????????	???????&?????????/&?????&?????????  *????;??J????K??J??? ?K??J ????K??J???K?????J??????K????	?5??  ????'???????&??,???????	????2?????&??	?*????B?? ?  *?????;???&??????&????&????????????????&???????????&???  ??? #????? ???&?? ????'? ??????&? ?????? ,?? ?&??? ??? ???5??  ???????? &??????????????&??*?????;(?1?)? &??#&???#?????????  &???????? ??????&? ??? ????&???????? #????? *???? ;(?)? &??#&?  ??#? ?? ??#? &???????? ??????? ???? ,?? ????&??????? 	??? ????  &????&????	?????'???????&??3??&??&??????&&???????	???????????   0.2  0.4  0.6  0.8   chat  exploit m  isc  netbios oracle policy  rpc  shellcode sm  tp  spyw are-put  sql  w eb-cgi  w eb-client  w eb-iis  w eb-m  isc w  eb-php Total  N or  m al  iz ed  p at  te rn  s iz  e  Category of Patterns  Original Signature Pattern Set Size(Bytes) Signature Pattern Set Size after Repetition Removal(Bytes) Primary Pattern Set Size after Deep Decomposition(Bytes)  8?	?? ?:!?9???????????????? ?????- ?   0.2  0.4  0.6  0.8   1.2  1.4  1.6  1.8   chat  exploit ftp imap  m isc  netbios oracle policy pop3  rpc  sm tp  spyw are-put  sql  w eb-cgi  w eb-client  w eb-m  isc w  eb-php Total  N or  m al  iz ed  p at  te rn  e nt  iti es  Category of patterns  Original Signature Pattern Count Signature Pattern Count After Repetition Removal Primary Pattern Count After Deep Decomposition  ?  8?	?? ?;!9???????????????? ??? ????? ??  2009 7th International Workshop on the Design of Reliable Communication Networks 363    we are pursuing: increasing the variation of edges between nodes rather than increasing the number of nodes, allowing different signature patterns to be easily reconstructed.

Efficient methods for implementing this reconstruction in hardware are an area of further study.

4.2 Statistical Verification In order to verify our premise that the number of primary  patterns increases at a much slower rate compared to the rapid growth of signature pattern databases, we extended our analysis of pattern decomposition to determine the variations across multiple versions of the Snort rule database. Since these versions represent the evolution of the Snort database over a period of several years, this experiment presents us a clear view on the relationship between growth in the number of signature patterns and growth in primary patterns.

We have analyzed the series of signature pattern sets currently available, representing seven major public versions of Snort rule databases. They include V2.1 to V2.4 and V2.6 to V2.8, which were released over a period from April 2005 to October 2008. Although new types of rules were added to rule databases to accommodate the continuous evolution of network intrusion patterns, major parts of Snort rule databases still follow an accumulating update policy. From V2.1 to V2.2, V2.3 to V2.4 and V2.6 to V2.8, the corresponding types of Snort rules were increased from 48 to 50, and later to 52.

However, the sizes of rule database inflated from 935Kb to 8.86Mb.

The number of pattern entities and the size of pattern sets are two key parameters that we are interested in. With these, we are better able to determine the growth relationship between signature patters and primary patterns. By extracting the ?content? signature pattern rules from the databases, we obtain the original signature pattern sets, summarized in Table 1. The size of the signature patterns grows from 31.1kB in  version 2.1 to 164.2kB in version 2.8. We then further decomposed each set of original signature patterns down to primary pattern sets following the two-step decomposition procedure presented in Section 3.

Table 1. Summary of parameters of signature pattern set and primary pattern set in different versions  Version Signature Pattern Set Primary Pattern Set Entities Size Entities Size  2.1 2,739 31.1 kB 2,432 11.7 KB 2.2 3,442 33.0 kB 2,501 11.7 KB 2.3 25,802 145.3 kB 5,856 32.9 KB 2.4 26,936 147.9 kB 5,867 32.9 KB 2.6 31,103 164.1 kB 6,482 37.0 KB 2.7 31,097 163.9 kB 6,525 36.9 KB 2.8 31,156 164.2 kB 6,523 37.0 KB  The plot in Figure 8 illustrates the incremental increase in the size of the decomposed database as the number of signature pattern entities increases. From the most recent set of rules tested (version 2.8), the netbios content signature rule set was selected, since it is the largest set of rules.

Because the rules do not contain a timestamp indicating when they were added to the database, the rules were randomized to minimize the effect of grouping within the file.

To generate the plot, one additional rule was added to the database at each step, and the size of the database after two-step decomposition was recorded. Thus, the graph shows the incremental growth in the primary pattern set size as the signature set size increases.

Clearly, as the number of signatures increases the growth of the primary pattern set size appears to be decreasing rapidly.

The individual points on the plot show where the netbios (signature pattern set size, primary pattern set size) pairs fall on this plot.

Note that except for version 2.8, the points do not exactly fall on this curve since the rules were incrementally added in random order and some rules may differ between versions.

However, the points do show good agreement, justifying the sampling procedure used to generate the plot.

While Figure 8 supports our premise that after reaching some practical size, the number of primary patterns saturates and is unlikely to increase significantly with incremental increases in the number of signature patterns in the database, we cannot say for certainty that this is indeed the case. Many of the signature pattern sets in the snort database are too small to have reached the point of saturation and the database as a whole, being composed of many types of traffic, also have not yet reached the point of saturation.

Despite this, the signature pattern sets all exhibited sub-linear incremental growth when analyzed. Furthermore, even if the database never reaches the saturation point given changes in service types, the overall reduction in size achieved by our two-step decomposition procedure still justifies the use of static signature pattern decomposition and dynamic reconstruction.

