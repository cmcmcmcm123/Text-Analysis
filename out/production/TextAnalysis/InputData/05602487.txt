SICE Annual Conference 2010  August 18-21, 2010, The Grand Hotel, Taipei, Taiwan

Abstract?With increasing Internet popularity, network secu- rity has become a serious problem recently. Therefore, a variety of algorithms have been devoted to this challenge. Genetic Net- work Programming is a newly developed evolutionary algorithm with directed graph gene structures, which has been applied to data mining for intrusion detection systems and has shown that it provides good performances in intrusion detection. In this paper, a hybrid rule mining algorithm based on Fuzzy GNP and probabilistic classification has been proposed. Hybrid rule mining uses fuzzy class association rule mining algorithm to extract rules with different classes. Then, using different class rules and the classification of data is done probabilistically. The hybrid methods showed excellent results by the simulation experiments.

Keywords?Intrusion detection, Genetic Network Program- ming, Hybrid rule, Fuzzy GNP, Probabilistic classification, Fuzzy class association rule

I. INTRODUCTION  Nowadays, as computer and communication technologies develope, damages caused by an intrusion and crimes related to computer systems have been increasing. Therefore, the network security which can ensure the system to behave as intended and to provide stable services becomes an important matter. An intrusion detection system emerged to detect several types of malicious behaviors that compromise the security and trust of a computer system. Intrusion detection can extract information from a computer or a network of computers, and attempt to detect the presence of intrusion from external sources, as well as the system abuse by authorized users.

Generally, intrusion detection is to separate the abnormal data from the normal data. Therefore, the problem of intrusion detection can be composed of two parts. The first part is how to extract useful information from the history database, then how to organize such useful information to make accurate classification.

The conventional main intrusion detection techniques are misuse detection and anomaly detection. Traditional misuse detection approach detects intrusions based on the patterns of known attacks, which has high detection accuracy for the attacks having similar features to known ones. But, it fails to recognize a brand new attack usually. Whereas, anomaly detec- tion detects new attacks by modeling the normal activities of the network traffic and determining whether the deviation from the established normal patterns can be regarded as intrusions.

However, the patters of normal activities may contain intrusion traces, and also the activities of legitimate users may deviate  from patters of the normal activity. All the two aspects may lead to high false alarm rates[1][2].

Genetic Network Programming(GNP), which is a kind of evolutionary algorithms has been proposed in recent years and applied to many fields such as traffics, stocks, elevator control and etc.. It has a unique directed graph structure which is dis- tinguished from the string structure of Genetic Algorithm(GA) and tree structure of Genetic Programming(GP). The nodes in GNP can be reused during evolutionary processes. This is just a distinct feature for making GNP mine a lot of important rules from the database, [3]-[6].

In this paper, a hybrid rule mining using GNP combined with probabilistic classification is proposed. On the basis of the combination of misuse detection with anomaly detection, fuzzy logic theory is introduced into GNP to extract fuzzy rules. Then, the probability density function of the average matching degree of the data with rules can be calculated. Based on this, new connection data can be classified into normal activity, known or unknown intrusion.

This paper is organized as follows. In section II, basic concept of GNP and traditional class association rule mining are briefly reviewed. Section III describes hybrid rules extrac- tion combining fuzzy logic theory with class association rule mining. Then, the probabilistic classification is introduced in section V. The simulation results using KDD99CUP data is given in Section IV, followed by conclusions in Section VII.



II. CLASS ASSOCIATION RULE MINING BASED ON GENETIC NETWORK PROGRAMMING  In this section, the basic concept of GNP and class associ- ation rule mining based on GNP are reviewed.

A. Genetic Network Programming  GNP is one of evolutionary algorithm. The directed graph structure is the distinct advantage of GNP[3]. GNP consists of three kinds of nodes. They are start node, judgement node and processing node. Fig.1 shows a basic structure of GNP.

The GNP in this figure has one start node, five judgement nodes and three processing nodes. The start node S is only for determining which node should be the first node to be executed. The set of J1,J2, ...,Jm represents judgement nodes which have conditional branch decision functions, and return judgement results so as to determine the next node. Processing nodes, like P1,P2, ...,Pn serve as action functions to determine  PR0001/10/0000-2614- 2614 -     S      4 5   S Start Node  Processing Node  Judgment Node  Fig. 1. Basic structure of GNP  ???  5   02  3  5  1   02  2  5  3   01  1  1Node 1  Node 2  Node 3  ? ?  Cik  dik?Ci2 di2Ci1 di1NTi  IDi di Cik  dik?Ci2 di2Ci1 di1NTi  IDi diNode i  Connection GeneNode Gene Connection GeneNode Gene  ?  Node 4  4   0  1  4  1 5   03   0 6   0  Fig. 2. Genotype expression of GNP  which action should be taken. The number of nodes and their concrete functions depend on the problem which are determined by the designers.

Fig.2 is the genotype expression of GNP in a GNP indi- vidual. NTi denotes node type. 0 is start node, 1 is processing node, 2 is judgement node. IDi works as the identification number. Ci1,Ci2, ... mean the nodes connected from node i, firstly, secondly,... and so on. And di1, di2,..., dik denote the time delays of the transition from node i to node Ci1, Ci2,..., Cik, respectively.

In addition, there are three kinds of genetic operators, selection, crossover and mutation in GNP.

B. Class Association Rule Mining Based on GNP  Association rules can discover the association relationships or correlations among a set of attributes in a database. Let I = {A1,A2, ...,Al} be a set of attributes and each tuple T has a set of attributes satisfying T ? I. Associated with each transaction is a unique identifier whose set is called TID.

So, an association rule can be represented by the form of X ? Y . The meaning of such an association rule is that tuples satisfying X are likely to satisfy Y , where X and Y are called antecedent and consequent of the rule, respectively.

If the fraction of tuples which contains X in the database equals x, then we say support(X) = x. The rule X ? Y has a measure of its strength called confidence (X ? Y ) defined as the ratio of support(X  ? Y )/support(X). Assume  support(X) = x, support(Y ) = y, support(X ? Y ) = z and the  total number of tuples is N. Then, ?2 of the rule X ? Y can  P1 N  A1=1  Yes side  No side P2  A2=1 A5=1 A9=1 a b c d  a(1) b(1) c(1) d(1)  Judgement nodeProcessing node  Fig. 3. Class association rule represented by GNP  be calculated as  ?2 = N(z? xy)2  xy(1? x)(1? y) (1)  If ?2 is higher than a threshold value(3.83 at 95% significance level, or 6.64 at 99% significance level), we should reject the independence assumption. In this paper, important association rules should satisfy the follow conditions:  ?2 > ?2min, (2)  support ? supmin, (3)  confidence ? confmin, (4)  where, ?2min, supmin and con fmin are the minimum of ?2, support and confidence values given in advance.

Class association rule mining aims to find all the rules from the database that form an accurate classifier, where the consequent is a classification attribute. Attributes and its values are corresponding to the functions of the judgement nodes in GNP. The connections of judgement nodes are represented as class association rules like the following form.

(Am = 1)? ...? (An = 1)? (C = k) (5)  GNP examines the attribute values of database tuples using judgement nodes and calculates the measurements of associa- tion rules using processing nodes. Judgement node determines the next node by a judgement result of Yes or No correspond- ing to Yes-side or No-side. Yes side of the judgement node is connected to another judgement node. Judgement nodes can be reused and shared with some other association rules because of GNP?s feature. Fig.3 is an example to explain how class association rules can be generated by GNP. P1 is a processing node which serve as the beginning of a class association rule.

A1, A2, A5, A9 denote the function of the judgement nodes. N is the number of total tuples. a, b, c, d, a1, b1, c1, d1 are the numbers of tuples moving to the Yes-side at each judgement node and the number of tuples moving to Yes-side at each judgement node under the condition of class 1, respectively.

So, we can get many candidates of rules which have the form like equation 5.

- 2615 -     P1  N  A1  Yes side  No side P2  A2 A5 A9 a b c d  a(1) b(1) c(1) d(1)  Pt Pt  Fig. 4. Node Transition in Hybrid Rule Mining based on Fuzzy GNP

III. HYBRID RULE MINING  In this paper, hybrid rules are extracted and later used for classification. Hybrid rule mining is a synthetic method con- sidering both data type and linguistic type, discrete attributes and continuous attributes.

A. GNP-Based Fuzzy Class Association Rule Mining  GNP examines the attribute values of database tuples using judgement nodes and calculates the measurements of associa- tion rules using processing nodes[5]. Attributes and their val- ues correspond to judgement nodes and their judgement values in GNP, respectively. The conventional representation of class association rules based on GNP is described in Fig.3. In this paper, hybrid rule mining successfully combines Fuzzy GNP with conventional class association rule mining, which utilizes discrete attributes and continuous attributes in one single rule.

Fig.4 shows an example of hybrid rule mining representation.

The rule extraction starts from the first processing node P1 and connects to a judgement node as shown in Fig.4. The first judgement node examines the fuzzy membership value of the continuous attribute A1 as Count high, the second judgement node examines the value of binary attribute A2 as Land = 1, the third judgement node examines the value of symbol attribute A5 as Service = htt p and the following judgement node examines another fuzzy membership value of continuous attribute A9 as Duration low. N is the number of total tuples. The Pt in Fig.4 is the probability moving to the Yes-side. In first judgement node, GNP selects Yes-side and goes to the next judgement node when random value selected in (0,1) is smaller than the certain probability Pt which equals to the fuzzy value of the corresponding attribute. Otherwise, the connection will turn to another processing node and start to examine other rules.

B. Fuzzy Membership Functions for Continuous Attributes  Fuzzy theory came from the desire to describe complex systems with linguistic descriptions[7]. In most of the real- world applications as data mining, the types of data are complex, i.e., not only including the type of boolean, many other types are also included. In this paper, we utilize the advantage of fuzzy theory allowing every continuous attribute to have membership values in [0,1]. Each continuous attribute in the database is transformed into 3 linguistic terms (Low, Middle and High) in the paper. Besides, the membership function of each continuous attribute is evolved.

a ? ?

Low  Middle  High  Fu zz  y m  em be  rs hi  p va  lu e  Fig. 5. Fuzzy Membership Function  Actually, these linguistic terms are defined by the com- bination of trapezoidal and triangular membership functions symmetrically spaced. The parameters ? , ? and ? of the fuzzy membership functions are shown in Fig.4, which are also evolved along with GNP evolution. Each continuous attribute is associated with its own membership functions. Non-uniform mutation was used for the evolution of the fuzzy membership functions. Once a GNP individual starts the searching for association rules, the fuzzy membership values are used to determine the transitions in GNP individuals, which will be explained in the next section.

C. Nonuniform Mutation of Fuzzy Membership Functions  Each continuous attribute has its own fuzzy membership function. The parameters ? , ? for each continuous attribute Ai are initialized by analyzing the distribution of data. Then, ? is automatically calculated by (2? ??). During the whole evolution process, the parameters ? , ? , ? of the fuzzy member- ship function should be adjusted generation by generation, so as to get more appropriate distribution of parameters. From the second generation the parameters are selected by non-uniform mutation with the probability of Pm. Let xk be a parameter selected for mutation in the kth generation, then we can see xk+1 as follows.

xk+1 =  { xk+?(k,UB? xk),when ? is0; xk??(k,xk?LB),when ? is1;  (6)  where, UB and LB are the lower and upper bounds of the variable xk, and ? is a random binary value in {0,1}.

The function ?(k,y) returns a value in (0,y), where ?(k,y) approaches 0 as k increases. Such property causes the operator to search the space uniformly at first and very locally in the later generations. The actual ?(k,y) can be calculated by the following equation:  ?(k,y) = y(1? r(1?k/T )? ) (7) where, r is a uniform random number in (0,1), T is the maximal generation number and ? is a system parameter determining the degree of dependency on the iteration number.

D. Fitness Function  In this paper, we defined the fitness function of GNP individuals as  F = ? r?R  {?2(r)+10(n(r)?1)+?new(r)}, (8)  - 2616 -     where, R is set of suffixes of extracted important rules; ?2(r) is ?2 value of rule r; n(r) is the number of attributes in the antecedent of the rule r. ?new(r) is additional constant defined by the following equation  ?new(r) =  { ?new, rule r is new, 0, otherwise.

(9)

IV. PROBABILISTIC CLASSIFICATION  After extracting a number of important class association rules including normal and intrusion, a classifier is constructed to classify new connection data into normal, misuse and anomaly intrusion correctly. The key points of probabilistic classification concerns three aspects. First, the probability density function of the average matching degree of data with rules is used. Second, the probability that data is classified to anomaly intrusion is also considered. Third, in order to improve the classification accuracy, weights are used to revise the probability.

A. Probability Density Function  Before applying the probabilistic classification, the proba- bility density function should be generated. First, the matching degree of each data d with every rule in the rule pool is calculated. Here, the matching degree between data and rules consists of two parts, i.e., the matching degree for continuous attributes and the one for discrete attributes. The definition of the matching degree between the continuous attribute Ai with linguistic term Qi and data ai of attribute Ai is represented as :  MatchDegreek(Qi,ai) = FQi(ai), (10)  where, FQi represents the membership function of linguistic term Qi. Then, the matching degree between data and rule r (including p continuous attributes and q discrete attributes) is defined as :  Matchk(d,r) =  p+q ( ? i?CA  MatchDegreek(Qi,ai)+ t), (11)  where, i is the suffix of continuous attributes in rule r; CA denotes the set of suffixes of continuous attributes in rule r; p and q represent the number of continuous attributes and discrete attributes in rule r, respectively, and t is the number of matched discrete attributes in rule r with data. Then, the average matching degree can be defined as  mk(d) =  |Rk| ?r?Rk Matchk(d,r), (12)  where, Rk is the set of suffixes of the extracted rules in class k in the rule pool(normal rules or misuse rules).

Finally, the marginal probability density function f1(x1), f2(x2),... fk(xk),..., fK(xK) can be generated by calculating the distribution of the average matching degree of training data d ? Dtrain(k) with r ? Rk, where, Dtrain(k) is the set of suffix of training data in class k. K = 2 is used in this paper.

B. Building a Classifier  After creating the probability density function fk(xk) of the average matching degree between training data d ? Dtrain(k) and rule r ? Rk, the probability that new connection data d ? Dtest belongs to class k is represented as follow:  Pk(d)= ? 1.0 mK(d)  fK(xK)dxK . . .

? mk(d)  fk(xk)dxk . . .

? 1.0 m1(d)  f1(x1)dx1,  (13) where, Dtest is the set of suffix of testing data. Actually, the probability that d ?Dtest belongs to anormaly class is defined as:  P0(d) = 1? ? k?C Pk(d), (14)  where, C is the set of suffix of classes having training data. In the case of two classes, the probabilities of the first class and the second class can be calculated by the following equations.

P1(d) = ? 1.0 m2(d)  f2(x2)dx2 ? m1(d)  f1(x1)dx1 (15)  P2(d) = ? m2(d)  f2(x2)dx2  ? 1.0 m1(d)  f1(x1)dx1 (16)  Then, the probability that a new connection data belongs to anomaly class is calculated by P0(d) = 1??k?C Pk(d). Based on the calculation of these probabilities, d is assigned to the class with highest probability.

C. Revision of Probability  In intrusion detection, in order to balance positive false rate(PFR) and negative false rate(NFR), we assigned the following weights to adjust Pk(d) and P0(d)  Pk(d)? wkPk(d)w0P0(d)+?k?C wkPk(d) , (17)  where, w0 and wk (k ?C) are the weight parameters.



V. SIMULATION  The simulations were conducted on the intrusion detection database of KDD CUP 1999(KDDCUP?99) which is publicly available. This dataset was collected from a network simulat- ing a typical U.S. Air Force LAN and also reflecting dynamic changes within the network.

The KDDCUP?99 intrusion detection dataset contains a standard set of data to be audited, which was developed based on the 1998 DARPA intrusion detection evaluation program, prepared and managed by the MIT Lincoln Laboratories. In the KDDCUP?99 dataset, each record represents a TCP/IP network connection with a total of 41 features. All the con- nections can be divided into 5 categories including normal network connection, and other four categories are Denial- Of-Service(DOS), RootToLocal(R2L), UserToRoot(U2R) and Probing[2][8]-[10].

We choose 10,000 network connections from KDDCUP?99 dataset which consists of 5,000 normal network connections and 5,000 intrusion network connections including two kinds of attack connections, neptune and smur f . The program was based on the Fuzzy GNP algorithm and executed for 10 rounds  - 2617 -     TABLE I PARAMETERS FOR FUZZY GNP  Parameter Value Populationsize 120 Generation 1000  Processingnode 10 Judgementnode 100 Crossoverrate 1/5 Mutationrate1 1/3 Mutationrate2 1/3  Minimum support 0.1 Minimum con f idence 0.8  Minimum ?2 6.63  start  Initia lize  populations randomly  fuzzyfication of continuous attributes in tra ining database  Extraction hybrid rules combining Fuzzy part  Calcula tion of the  support, confidence and X2 h y b rid  ru le  b as ed  o n  Fu zzy  S tore the new  rule  Update the rule pool R ule P o o l  support>supmin  confidence>confm in  X 2>X 2m in  last generation  No  M utationRate-1  M utationRate-2  Nonunifo rm method to adjust parameters o f Fuzzy  M embership Function  Crossover  EliteSelectRate  Yes  Stop  Yes  Fig. 6. Flow Chart of Hybrid Rule Mining using Fuzzy GNP  in order to calculate the average result. Its flowchart is shown in Fig. 6. We could extract about 30,000 to 40,000 rules through evolution, and about 10% of which are normal rules and the rest 90% are misused rules.

The testing dataset contains 10,000 network connections which are also randomly selected from KDDCUP?99 dataset.

Besides normal network connection and two kinds of attack connections, i.e., neptune and smur f , there are another four kinds of unknown intrusions, namely portsweep, satan, nmap, ipsweep.

TABLE II TESTING RESULTS BASED ON CONVENTIONAL CLASS ASSOCIATION  RULE MINING  Normal(C) Known(C) Unknown(C) Total Normal(R) 1591 237 102 1930 Known(R) 94 7633 161 7888 Unknown(R) 82 9 91 182  Total 1767 7879 354 10000  The classification results of conventional method and pro- posed method are shown in Table.II and Table.III, respectively.

Here, the classification results are evaluated by DR(detection  TABLE III TESTING RESULTS BASED ON THE PROPOSED METHOD  Normal(C) Known(C) Unknown(C) Total Normal(R) 1734 83 113 1930 Known(R) 68 7490 330 7888 Unknown(R) 38 6 138 182  Total 1840 7579 581 10000  rate), PFR(positive false rate), NFR (negative false rate) and Accuracy. Among these four evaluating standards, DR is the total detection rate; PFR represents the probability that the normal network connections are classified as intrusion ones; whereas NFR denotes the probability that the intrusion net- work connections are classified as normal ones; and Accuracy means the network connections classified correctly.

DR, PFR, NFR and Accuracy of the Fuzzy GNP are  calculated as follows:  DR= (1734+7490+138+330+6)/10000= 96.98% (18)  NFR= (68+38)/(7888+182) = 0.48% (19)  PFR= (83+113)/1930= 10.16% (20)  Accuracy= (1734+7490+138)/10000= 93.62% (21)  and those of the conventional class association rule mining method are  DR= (1591+7633+91+161+9)/10000= 94.85% (22)  NFR= (94+82)/(7888+182) = 2.18% (23)  PFR= (237+102)/1930= 17.56% (24)  Accuracy= (1591+7633+91)/10000= 93.15% (25)  We can see from the above comparisons that the proposed method has higher DR, Accuracy and lower NFR, PFR than the conventional method. So, Fuzzy GNP outperforms the conventional class association rule mining method, because Fuzzy GNP overcomes the crisp boundary problem and has the ability to deal with multi-datatype databases. Moreover, the parameters of fuzzy membership functions are tuned by nonuniform method during the evolution process in each generation till the optimal parameters are selected. During this processing, more important rules can be extracted sufficiently which could ensure the efficiency and interpretability of the proposed method.



VI. CONCLUSION  The proposed method, that is, hybrid rule mining algorithm based on GNP, combines Fuzzy-based class association rule mining and probabilistic classification in order to extract more important rules from the database. In addition, the classification method is based on the probability distribution of the average matching degree between data and different class rules. As a result, simulations show higher DR, Accuracy and lower PFR, NFR, which means that Fuzzy based GNP class association rule mining has better performance than the conventional class association rule mining.

