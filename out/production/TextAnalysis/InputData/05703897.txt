Studying Herb-Herb Interaction for Insomnia through the theory of  Complementarities

Abstract? The efficacy of a TCM medication derives from the herb-herb interaction in a formula. Although there are standard formulae, a practitioner will only pick a subset of formulas as templates and personalize them for the patients. It is not easy to determine the true interacting herbs to contribute to the effectiveness of a treatment. Association rule mining is an approach to find the co-occurrence of some items, however, it is not goal-oriented, and the generated results are very sensitive to the given parameters, i.e. support count. The aim of this paper is to introduce a new framework to systematically generate a set of combinations of interacting herbs that leads to good outcome. This algorithm was tested with a dataset of treatment of insomnia to understand the effectiveness of combination of herbs. Interesting and insightful results were noted and discussed.

Keywords- interaction, complementarity, super-modular function, insomnia

I. INTRODUCTION While medications in western medicine often strive to  avoid drug interaction, Traditional Chinese Medicine (TCM) works in the opposite way by exploiting the useful interaction among multiple herbs in a formula (prescription).

The efficacy of a TCM medication comes from the interaction of these herbs. Although there are standard formulae, a practitioner will only pick a subset of formulae as templates and personalize them for the patients. Since a doctor can add or remove or replace herbs in the template(s), the preparation of a prescription is a science as well as an art.

As a result, it is not an easy task to determine the true interacting herbs that contribute to the efficacy of a treatment. Association rule mining (ARM) is a potential candidate to find the co-occurrence of items (which will be herbs in our case). However this method suffers from two aspects. This algorithm requires the definition of thresholds (e.g support count) prior to execution. The results are sensitive to these thresholds (as parameters). A different set of parameter values will give a very different result. Also, there is no scientific way to determine the correct threshold value; it is largely a trial-and-error exercise. A threshold with high value will severely reduce the number of results produced, whereas a small threshold will offer too many answers to be useful. Another issue is that ARM is not goal- oriented. There is no proof or support that co-occurrence of herbs indicate their interaction, hence, it cannot help a person with a specific question.

The aim of this work is to propose complementarity as a surrogate of herbs interaction. A new algorithm is introduced to discover all the possible sets of interacting herbs, and it does not rely on any threshold value (parameter-free).

Related work will be described in Section 2, while Section 3 gives an overview of our proposal method. An insomnia dataset will be described in Section 4. Experimental results will be presented in Section 5. Section 6 is the discussion.

Conclusion and future work can be found in Section 7.



II. RELATED WORK Association rule mining is considered to be the  cornerstone of data mining research. The objective of this      technique is to find dependencies between different variables (called items) in a large database. Unlike a standard statistical approach to test for correlation between variables, association rule mining casts the problem as a search for dependencies (called association rules). Support and confidence are two measurements to guide the search process. The earlier research in association rule mining has focused on algorithms for discovery [1] and more recently on pruning [2].

However, it is also well known that the standard measures of support and confidence are not objective enough for generating rules (need to rewrite). To improve objectivity, one approach is based on some interestingness measures to guide the selection process. Several other statistical measures of interestingness have been proposed, and [3] provided an extensive analysis of the properties of the different measures. Other approaches have also been proposed to determine the interestingness of a set of frequent itemsets using background knowledge in the form of prior beliefs of the user [4]. There are several advantages of using interestingness measures. One advantage is to allow users to compare rules objectively. Another one is the provision of statistical significance, e.g. Brin [12] suggested using a Chi Squared statistic that takes advantage of the upward closure property. Essentially this means the statistic is strictly increasing with the itemset size and the number of variables.

As [5] point out their approach has the flaw that this is not true with increasing item set size as the degrees of freedom are not constant.

One other way to address the interaction is to create a network [10] from the prescriptions and select important herbs for further analysis. The authors applied MDR to the reduced feature set to find the nonlinear relationship among the herbs and to generate the sets of herbs that are useful..



III. COMPLEMENTARITY & SUPERMODULAR FUNCTION Many existing works consider interaction as additive  interaction, while we want to pursue interaction that is more than additive. If we are using two variables as an example, then our aim is to identify those factors have the property of  f (a?b)  f (a) + f (b)  where a?b indicates the interaction effect of two factors.

The concept of complementarities is a surrogate for interaction. It offers a useful perspective to study the complex relationships between inter-related variables. This concept was first introduced by Edgeworth in which he defined factors as complements if doing (more of) any one of them increases the returns to doing (more of) the others. The notion of complementarity requires only that some ordering of the objects under consideration is in place. This observation has led to the actual formalization of the concept in the mathematical theory of lattices, which is the basis for the development of monotone optimization problems pioneered by Donald Topkis [6]. By drawing on lattice theory and supermodularity, Milgrom and Roberts [8, 9] proposed the ?web of complementarities? theory which marked an important new direction for research in the  economics research discipline. They argued that some of the organizational activities and practices are mutually complementary and so tend to be adopted together, with each enhancing the contribution of the other. The ?supermodularity? of a function will be used to identify the complementarities [6]. Supermodularity dictates that the sum of the increases in the value of a function. If complementarities among activities exist, then the gains from increasing every feature are larger than the sum of the individual increases. In other words, a test for complementarities must consider performance data on some function that is hypothesized to be supermodular.

Suppose there are two herbs H1 and H2. Each herb can be used in a formula (H1=1) or not (H1=0) and (H2=1) or not (H2=0). The function f(H1,H2) is supermodular and H1 and H2 are complements only if: f(1,1) + f(0,0)  f(1,0) + f(0,1) This concept has also been used in conjunction with contingency and configuration [9]. This definition can be scaled up for multiple variable complementarities. In a more general way, when a vector of numbers in k-dimension, a function of f: Rk  R is said to be supermodular if  f (x ? y) + f (x ? y)  f (x) + f (y) (1)  ? x, y ? Rk, where (x ? y) denotes the component-wise maximum and (x ? y) the component-wise minimum of x and y. In other words, the heuristic is to measure the marginal gain over the baseline and the separate effect due to each individual variable. Figure 1 is the pseudo code which incrementally finds all the interactionsets, i.e. sets of interacting variables. Each interactionsets must meet two conditions: the necessary and sufficient conditions.

It will not be possible to calculate the supermodular value of a pattern (herbs) if the dataset does not contain all the possible combinations of the pattern. The existence of all the permutations is the necessary condition which is related to lines 11-15 in the algorithm (Figure 1). Once the necessary condition is satisfied, a pattern can go through the sufficient condition testing by calculating its supermodular value (lines 16-22). A pattern is considered complementary (or interacting) when a positive value is derived..



IV. DATASET Insomnia is a ?nightmare? to many people. It refers to the  poor quality of sleep or insufficient sleep duration, it can lead to adverse daytime consequences. Studies have shown that rates of insomnia with associated daytime dysfunction in attendees of general medical practices range from 10% to as high as 34% [13]. Therefore, insomnia is a popular, important and vital disorder that needs to be addressed.

We have selected and labeled 460 insomnia outpatient encounters from a TCM hospital in Beijing. The outcome of each encounter was annotated by TCM clinical experts who went through the changes of the insomnia-related variables over consecutive visits; these include the sleep time per day, sleep quality and difficulty in falling asleep. The outcomes are then classified into two categories: good and bad. When a treatment was effective, which means that if the patient recovered completely or partly from insomnia in the next     encounter, then the prescription of the current encounter would be categorized as ?good?; otherwise, the herb prescription would be categorized as ?bad?.

After labeling these 460 outpatient encounters, there are 68 encounters with bad outcomes in this dataset; in other words, it is an imbalanced dataset. The average good outcome rate (GOR) of the whole data set is 392/460=85.21%. There are 261 distinct herbs in the dataset and there are on average 14 herbs in a formula. In current stage, we ignored the dosage of each herb but only recorded whether an herb is used, i.e. it is represented in binary format. Each encounter has an entry for each herb, while the zeros and ones indicate the herbs actually prescribed in the current formula.

1. k = 1 2. Ck ? all variables that have {0,1} 3. repeat 4. k = k + 1 5. PC = ? 6. PC = potential-complement-gen(Ck) 7. generate-ITable for each c in PC 8.  for each data record d ? D do 9. Update the count & f  in each ITableis, c 10. end for // testing necessary condition 11. for each ITable ctis, c do 12. if ITable-complete(ctis, c) 13.    add c to Ck 14. endif 15. endfor  // testing sufficient condition 16. Sk = ? 17.  for each c in Ck do 18. Calculate the supermodular value (s-value)  from the corr ITable ctis, c entry 19.   if s-value > 0 20.    add c to Sk 21.   Endif 22.  Endfor 23.  Result = ? Sk 24. until Ck = ?  Figure 1. Algorithm to generate interactionsets

V. EXPERIMENTS AND RESULTS We prepared to run three different experiments by using  different functions to calculate the supermodularity. The function in the first experiment was to count the occurrence of good outcome. The second one was similar to the first one, except we included an additional constraint of f(11)>f(00) in addition to Eq.1 to ensure the combined effect has to be better than the baseline effect (when none of the herbs being applied). In the third experiment, instead of simply using count, we used a ratio to measure the relative success, which is     1_  1_ ? ?  patternoutcomebad patternoutcomegood  Also, 1 is added to both the numerator and denominator to overcome the potential problem of having zero occurrence of bad_outcome of the pattern.

Experiment 1. There were 3,724 2-way interactionsets obtained for the necessary condition and 3,513 of them finally satisfied the sufficient condition. Table 1 shows the top 5 two-way interactionsets. The program further explored the three-way interactionsets and it has generated 23,743 candidates (meeting the necessary conditions) with 3,620 interactionset that qualified the sufficient condition to indicate true interaction.

Experiment 2. It had the same number of 3,827 2-way interactionsets obtained for the necessary condition but, this time, there was only one that finally satisfied the sufficient condition, which was <VAR33, VAR237> (< , >). For 3-way interaction, it finally came to the following two patterns: <VAR33,VAR200,VAR237> <VAR33,VAR236,VAR237>  which corresponds to <Indian bread, common anemarrhena rhizome, stir-frying spine date seed> (< ,  , >) and <Indian bread, fresh liquorice root, stir-frying spine date seed> (< , , >).

TABLE I. TOP 5 2-WAY INTERACTIONS USING COUNT  stir?frying?bitter? apricot?seed  cardamon?fruit  cochinchinese? asparagus?root  germinated?barley  Jiao?hawthorn?fruit Jiao?Malt  prepared?common? monkshood? daughter?root  largetrifoliolious? bugbane?rhizome  danshen?root fourleaf?ladybell? root  germinated?barley szechwan? chinaberry?fruit  Experiment 3. Using the ratio approach, the number of 2- way interactionsets, 546 pairs satisfy both the necessary and sufficient conditions. Table 2 shows the top 10 two-way interactionsets. In the search for the three-way interactionsets, 49 3-way combinations are found.



VI. DISCUSSION The numbers of 2-interactionsets and 3-interaction-sets  are too many to be useful in Experiment 1. Though these 3000-odd interactionsets qualified the basic super-modularity requirements, the top 5 pairs did not seem to be anywhere specific to insomnia when we examined each of them individually from Table 1. Hence, if we used the basic     supermodular function as a criterion, the results were not encouraging. One possible reason for this disappointing observation may due to the fact that the effectiveness of f(11) was far inferior to the baseline, f(00).

As a result, an extra condition was introduced to ensure f(11) must have a better performance than f(00). The inclusion of this new criterion has dropped the number of interactionsets to just one pattern of 2-way interaction and two for the 3-way interaction. The results found were all relevant herbs used for tranquillization in the Suanzaoren Tang ( ).

The resulting single pair and two triplet in Experiment 3 are the herbs used in Suanzaoren Tang. In other words, the process rediscovered the core herbs in a well known formula.

The results in Table 2 from Experiment 3 were interesting though some of them are out specifically used to address insomnia. For example, according to the TCM doctor, the first pair of <Chinese date, fresh ginger> has the function to harmonize the qi and blood, yingfen and weifen, spleen and stomach, but it is mainly used as an assistant rather than as master herbs. The second and third pairs are not typical relevant to insomnia as well. The pair-5,6 and 10 are typical herb-pairs for Liuwei Dihuang Pill ( ). The spline date in pair-4 and -7 is for nourishing the heart and tranquillization, while the purpose of the second herb in both cases is to nourish spleen and kidney yin. Pair-8 and -9 are considered interesting discovery in this list. For example, cassia bark in the 9th pair, traditionally teams up with golden thread in Jiaotai Wan ( ), has the purpose of restoring normal coordination between heart and kidney. Its current pairing up with Indian bread which can strengthen the spleen, eliminate the dampness and tranquillization has clinical implication.

TABLE II. TOP 10 2-WAY INTERACTIONS USING RATIO  Chinese?date fresh?ginger  fresh?ginger chinese?thorowax?root  golden?thread fresh?liquorice?root  common?yam? rhizome  stir?frying?spine?date? seed  indian?bread light?wheat  dried/fresh? rehmannia?[root]  asiatic?cornelian?cherry? fruit  asiatic?cornelian? cherry?fruit  stir?frying?spine?date? seed  prepared?thinleaf? milkwort?root  szechwan?lovage? rhizome  indian?bread cassia?bark  dried/fresh? rehmannia?[root]  common?yam?rhizome  An interesting observation from these experiments is that using the typical occurrence count can lead the popular and known herb combination, while the use of ratio approach  does not always have good results, but it has led to some surprising (and potentially useful) results. The question is: whether the existing herb-set theory has already been so well established that we modeled the computational approach to re-confirm the TCM theory, or we should explore new functions to enable the discovery of seemingly uninspiring herbs combination.



VII. CONCLUSION To identify the herbs that truly interact in a formula is an  important research in TCM. This paper has proposed the use of complementarity to explain the interaction effect, which is indicated by the value of a supermodular function. A new parameter-free algorithm was designed to incrementally search for all the herbs combination. The algorithm was applied to a clinical dataset on insomnia treatment from a Beijing TCM hospital. Generated results were commented by TCM practitioners. It is encouraging that interesting and new discoveries were found. Having said that the algorithm is free from the worry of determining the parameter values, it is not completely trouble-free; another problem has shown up. Three different functions were used in our experiments and different results were reported. Hence, one of the future works is to identify the most appropriate function to be used in the TCM context. Another future direction is to explore if the herb-herb interaction is stronger under existence of other herbs, i.e. to look for computational approach to support the theory of master-deputy-assistant-envoy ( ) [11]. It also became obvious from the discussion with the TCM doctors that herb-herb interaction without any associated knowledge on symptoms and/or syndromes is a major handicap. The search for symptom-herb is also an important direction. Lastly, unlike ARM that uses anti-monotonic property to do the pruning, the computation performance of the new algorithm is a worthwhile direction to proceed, i.e.

parallel or cloud computing.

