Inferring individuals' sub-health and their TCM

Abstract-This paper represents an approach automatically  inferring users' sub-healthy state and the corresponding  Traditional Chinese Medicine (TCM) syndrome based on TCM  doctors' knowledge, so as to construct a system which helps users  recuperating from the sub-health by means of showing them the  relevant regimen. The system's framework involves utilizing  objects' facial features, feelings, and physical status to infer their  sub-healthy state and TCM syndrome, and providing the  relevant mental care plan and diet plan according to their TCM  syndrome. This paper also introduces the data collection for  training the inference model, and describes the algorithm of  association rule mining while the individuality of TCM doctor's  criteria in diagnosing is considered. Experiment results  demonstrate the effectiveness and efficiency of the proposed  method, and show the potential important role of the TCM in  diagnosing people's sub-healthy state, and helping them to  recuperate from it.

Keywords-Sub-health, TCM Syndrome, Auto-Diagnosis,  Rule Integration, individual difference

I. INTRODUCTION  Sub-health in traditional Chinese medicine (TCM) indicates  the intermediate state of human's physical status between  health and disease, embodying the degree of hislher health. The  sub-healthy state is interpreted by the TCM syndrome, such as  Cold, Hot, stasis of blood, and so on. The TCM focuses on the  recuperation of the individual's sub-health by conducting the  available regimen which corresponds to the hislher TCM  syndrome, while such regimen involves the food therapy, the   ShaoziLi Kenzo Ito Cognitive Science department Faculty of Software and Info.

Xiamen University Science  Iwate Pre? University  Xiamen, China Iwate, Japan  szlig@xmu.edu.cn  physical exercise, and so on. Sub-health draws a worldwide  attention, and it is called as "Century Disease" because of its  extensive society and special times. Therefore, in-depth study  of sub-healthy state based on the TCM theory will make an  important contribution to human medicine [1].

Generally, the sub-health state and the TCM syndrome is  diagnosed by four kinds of diagnosis techniques, called Sizhen  (derived from the Chinese lmiMsizhen]). Among them, the  Wangzhen C?i?) by observing the object's aspect such as face and tongue to diagnose, and Wenzhen ([0] i?) by inquiring the object's physical status and feelings to diagnose are often used.

It is obvious that such diagnosing ways are of sUbjectivity and  the diagnosis results are influenced by the individual criteria of  the TCM doctor, although helher is strictly trained by the TCM  teaching course. Thus, because of the difficulty of  understanding, the advantage of TCM in helping the people  recuperating from sub-health is still not widely recognized and  utilized now. Also, there are few papers in the literature that  reported the achievements about the application of TMC in  diagnosing individual's sub-health automatically and  improving their sub-health state.

With the objective to fully utilize the advantage of TCM in  the recuperation of sub-health, and based on the assumption  that the theory of TCM is reasonable and the TCM doctor has a  perfect discrimination capability although the uncertainty in  hislher diagnosis must be taken into account, this paper  proposes an approach of automatically inferring the users'  sub-healthy state and the corresponding TCM syndrome based  on TCM's Wangzhen and Wenzhen, so as to construct a     system which help them recuperating from sub-health by  means of showing them the relevant recovery plans such as  physical exercise, food therapy, music therapy and so on. After  describing the system's mechanism briefly, this paper  introduces the process of the data collection for training the  inference model of the sub-healthy state and the TCM  syndrome. For collecting such data set, the images of some  subjects' face and tongue are captured and the data about the  degree of their feelings and physical status at that time are  recorded some times at an interval of about two weeks. Then,  some TCM doctors are asked to give the sub-healthy state and  the TCM syndrome of these subjects by observing the collected  data. Further, the features extracted from the images of objects  for inferring are also depicted. Next, the algorithm of mining  association rules regarding the sub-healthy state and the TCM  syndrome from the above collected data set is described, while  it considers the individuality of TCM doctor's criteria in  diagnosis. Experiment results demonstrate the effectiveness  and efficiency of the proposed method, and show the potential  important role of the TCM in diagnosing people's sub-healthy  state, and helping them to recuperate from it.

The remains of this paper include the following parts.

Section 2 describes the system's mechanism briefly; Section 3  introduces the methods of data collection, human facial  features' extraction, the scaling of the sub-healthy state, and the  diagnosed results given by TCM doctors; Section 4 depicts a  rule mining algorithm that integrates different TCM doctors'  diagnostic information for inferring sub-healthy state and the  TCM syndrome automatically; Section 5 shows the experiment  results; And the last section gives the conclusions and the  future work.



II. SYSTEM'S MECHANISM  In TCM theory, the sub-health indicates the intermediate  state of the people between the health and the disease. It can be  represented by the degree belonging to 3 factors called  Heat/Cold, Interior/Exterior, and Deficiency/Excess, shown in  Fig.I. The gray zone denotes the scope of sub-healthy state.

Without the drug therapy, the individuals can be recuperated  from the sub-health by the regimen such as natural food  therapy, physical exercise, and so on. However, the sub-healthy  state will become serious and transfer to the disease state if it is  neglected. On the other hand, correspondent to these 3 factors,  the TCM syndrome are categorized into 13 classes. They are  cold, hot, deficiency of vital energy, stagnation of vital energy,  deficiency of blood, stasis of blood, deficiency of jin, phlegm  and excessive fluid, heart, lung, spleen, liver, kidney. They are  often used by the TCM doctors in diagnosing and prescribing  by Wangzhen, Wenzhen, and so on. The natures of many  natural foods and medicines in prescription annotated by TCM  are closed linked to these 13 kinds of classes.

Regimen, Movement, Food The"'PY. etc.

Interior  Excess  ? ' Health  Heat  Cold  Q ' Sub-Health Q ' Disease  Figure 1. Relationship between health, disease and sub-health  According to the above description, we see that it is  interested to construe a system that infers the objects'  sub-healthy state and their 13 kinds of TCM syndrome, so as to  help them recuperating from the sub-health. The system's  diagram is shown in Fig.2.

In order to be utilized easily, the object's images of face,  tongue, eyes are captured by the camera, and their  corresponding feelings and physical status are inputted by  keyboard. The features such as facial colors, eye statues,  tongue colors and textures are extracted. These features  incorporated with the corresponding data of the feelings and  the physical features are used to infer the sub-healthy state and  the TCM syndrome by the constructed inference model. With  the inferred sub-healthy state and the TCM syndrome, the  corresponding regimen such as food therapy, physical exercise  and so on is displayed by the system. Furthermore, by  repeating in using the system day and day, the showed care  plan can be adjusted according to the changing tendency of the  sub-healthy state.

Da1aCo?ction  H.mun sign " Face color  -- ?featmes .

?  ,.."''? I Answers to seili I  I  .Algl:rlhI::nmoduhs  V r-?I D?'? ? oiliru? r oM TCM.,..m.m.

1 " ____ .oM ?v UClpU I-  Figure 2. System Flowchart  In!c!."  H Sub-lli:a1I:h5t.aUshmoi\g 1ufudal can showing  ? Dirt pbn show1ng Exmise plm showlng  ? FeedbWi I r

III. DATA COLLECTION AND FEATURE EXTRACTION  A. Data collection/or training  The capturing equipments for data collection include a  computer, a video camera and a camera. Collected data  includes subjects' images of face, eyes, tongue, hands, and hair.

Besides those, the corresponding data regarding the degree of  the subjects' feelings and their various of physical status at that  time are also recorded, which involve 7 kinds of emotions  relevant to the Qiqing (derived from the Chinese 7 ,tl'f [qiqingD of TCM, and 10 criteria of physical status regarding  the health proposed by WHO. Table 1 shows the abbreviation  of all items of the questionnaire and their score range. Where,  18 questions' scores range from 0 to 5, and 0 means that  nothing bothers the subject himself. One question's score  ranges from -5 to 5, and -5 means over-thinness while 5 means  over-fatness. 5 questions' scores are 0 or 1, where 0 means  YES and 1 means NO. The subjects give the score of the  questions displayed on the computer, and these answers are  collected automatically.

TABLE 1. LISTS OF THE FEELINGS AND PHYSICAL STATUS  Score The abbreviation of questions  range  0-5 Happy, Angry, Sad, Fear, Forgetful, Surprise, Worry,  Thinking, Disgust, Fatigue, Positive, Adaptation, Persistence,  Resistance to ill, Fitness, Teeth state, Muscle and skin state,  Appetite  -5-5 Fatness  o or I Insomnia, Staying up late, Dandruff, White hair, Hair shedding  Furthermore, the data about the degree of the subjects'  sub-health state and the TCM syndrome given by 3 TCM  doctors by observing the captured images and the degree of the  corresponding feelings and physical status are also recorded.

The TCM syndrome composes of 13 kinds of classes, which  are cold, hot, deficiency of vital energy, stagnation of vital  energy, deficiency of blood, stasis of blood, deficiency of jin,  phlegm and excessive fluid, heart, lung, spleen, liver, kidney .

The scores range from 0 to 9, while 0 indicates that the object  does not suffer from the corresponding class. Further, the  scores from 1 to 3 indicate the symptom is light, the scores  from 4 to 6 indicate the intermediate degree, and scores from 7  to 9 express that the suffering is serious. As we know, TCM is  of sUbjectivity and the results of diagnosis are often influenced  by the individual criteria of TCM doctors. The data collected in  the above process is also affected by the individual difference  of these 3 doctors. Therefore, how to filter the confused  information from the collected data is a crucial issue in rule  mining of TCM diagnosis. In the next section, we focus on  resolving this problem and propose an algorithm that integrates  different doctors' diagnosis information for inferring the  objects' sub-healthy state and their TCM syndrome.

B. Feature extraction  In this paper, the feature extraction from facial images and  eyes' videos are executed.

Each time when the facial photos are captured, the room's  light is constant and the distance between the camera and the  face is constant too. Each facial photo is divided into six blocks  automatically according the different facial areas, just as Figure  3 shows. To each block, facial color features in ROB color  space and YCrCb color space is calculated by the following  three steps.

1. In each block, pixels which have not skin-like color  such as beard, eyebrows and hair are excluded by  threshold segmentation based on YCrCb  colorspace[2] .

2. For all remaining pixels in the block, the average of  YCrCb color components are calculated as this  block's YCrCb value.

3. Converting YCrCb color space into ROB color space.

Figure 3. Facial area division  Figure 4. Eys's Video Capturing  During the process of eye video capturing, a subject sits in  front of the computer screen, about 50 cm away. The camera is  displaced horizontally on the side of the screen as high as the  subject's eyes, and the lens is aimed to the subject's face, just  as Figure 4 shows. When the subject clicks on the start button,  an animation is showed on the screen. First, the screen colors  are alternated by black and white in a constant speed of 10  seconds/frame. Then a red circle with a diameter of one-tenth  of the screen's height, appears on the screen. It beats on the  screen randomly and its moving speed changes once every 10  seconds. Each time the speed is randomly set and saved as a  parameter. During the capturing, the room's light is constant.

The subject is asked not to move his face but to track the red  circle by his eyes. The process lasts for about one minute. After  the capturing, the circle's moving speed is saved with the  corresponding captured video.

The extracted features from eye videos in this paper  include: frequency deviation of eyes blink, average distance  deviation between the upper and lower eyelids, matching  degree of the tracking, the degree of eyes' gloss, ratio of  venation area and conjunctiva area.



IV. INFERRING THE SUB-HEALTH STATE AND TCM SYNDROME  In order to diagnose objects' sub-health state and their  TCM syndrome automatically with the extracted features such  as those described above, and the corresponding degrees of  their feelings and physical status, we take the sub-healthy state  or each class of TCM syndrome as a conclusion to mine  association rules from the training data set, and then derive the  corresponding deducing rules for all of them. Taking into  account the individual difference of the TCM doctors in  diagnosis, the proposed association rule mining algorithm  integrates multiple TCM doctors' diagnosis information. Each  step of the above method is depicted in the following.

Data preprocessing  The degree of the feelings and physical status is regarded as  the discrete data which does not need any additional process  for the data mining, whereas the extracted features are the  continuous data, and it is necessary for each feature to be  divided into some different intervals, which are used to match  the corresponding conclusions. In this paper, we use the  method called CAlM [3] for the feature space division.

Association rule mining  This paper uses the CloudApriori algorithm [4] to mine  association rules from the above-mentioned extracted features  and the feelings and physical status. There are many  interval-division methods in the traditional research of  association rule mining. But those methods are so hard that the  boundary elements are easily excluded outside the intervals.

Aimed to solving such problem, paper [5] conducted a concept  of fuzzy set which make the domain of quantitative properties  become fuzzy so as to soften the boundary. However, it still  has its flaw. Once the membership function is defined as a  precise numerical expression, there are no ambiguity any more  in the process of concept definition and uncertainty reasoning.

Accordingly, a concept division method base on Cloud model  was proposed in [6] which is available in the computation of  support, confidence and correlation. In this paper, for the  extracted facial features having fuzzy cross-cutting attribute  intervals, the minimum support is set to 0.001 and the  minimum interest is set to 0.83.

Rules pruning  The redundant and repetitive rules are needed to prune from  the large amount of rules obtained in the previous step. Our  paper uses three rules pruning methods. Before pruning, sorting  rules is needed. Algorithm 1 is the rule sorting algorithm.

Given rule ra and rule rb, ra > rb holds if any of the  following condition is satisfied.

1) ra s interest is larger than rb S 2) ra S interest is equal to rb sand ra s support is larger  than rb S 3) ra s interest is equal to rb S, ra S support is equal  to rb S and attribute number of ra s premise is smaller than rb S  4) ra and rb S interest, support and attribute number of premise are all equal, and record number of ra s conclusion  categories in database is smaller than rb S.

5) all the items mentioned above are equal, but ra is  trained earlier than rb Algorithml Rule Sorting Algorithm  The rules pruning algorithm is shown in algorithm 2.

Assume that R is the association rule set to be pruned and T is the training set.

1) Sort R according to algorithm 1.

2) Remove rb from R by redundant rules pruning[7},  if any two rules ra and rb in R satisfY those conditions:  ra :fa ?c,rb :fb ?c rb, fa cfb, fa and fb have  the same attribute intervals, and ra S interest is larger than rb S  3) Use lazy pruning[8}: a) To each record t in T , find out the first matching  rule r from R ,  delete t and record the result of r S classification  b) After all records have been checked in T, delete rule r whose correct classification times is 0 while wrong classification times is not O. Recheck those records that have  been covered by r.

c) Repeat step 3) until there are no those rules whose  correct classification times is 0 while wrong classification  times is not O. Add the obtained rules to C 4) For the rest rules in R use database coverage  pruning[9}:  a) For all rules r in R, if r can satisfY the record t in T, add r into C and remove all those records in T that can be covered with r.

b) ifr can not satisfY any record, delete it.

Algorithm 2 Rules Pruning Algorithm  Rule integration  Due to the system's high complexity, the uncertainty of  TCM doctors in diagnosis is caused by the impossibility of  them to observe and capture all dimensions of the problem.

The different doctors may give the different diagnosing results  to the same individual, which leads to the inconsistency of the  rules mined from the different doctors' diagnostic results. It is  necessary for us to integrate the rules mined from the different  doctors' diagnosis results.

It is noticed that not all the TCM doctors are good at  diagnosing all the classes of TCM syndrome. It can also been  seen from Fig. 5. The lines of blue withOmark, pink withD  mark, and orange with.6.mark indict the inference accuracy of  association rules regarding the sub-health and 13 classes of the  TCM syndrome, which are mined from the diagnosing results  of the TCM doctor #1, #2 and #3 recorded in the training data  set, respectively. Such inference accuracy is called individual  inference accuracy. It is obvious that for some certain classes  of the TCM syndrome, the individual inference accuracy based  on a certain doctor's diagnosis is pretty higher than the others.

For example, the 95.5% inference accuracy of the class of  deficiency of blood was achieved by the rules mined from the  diagnosing results of doctor #2, while only the 39% accuracy  was achieved regarding the class of the stasis of blood. It  assumes that the doctor whose diagnosis for a class can induce  the higher inference accuracy for the association rule mining is  regarded as one who is good at diagnosing this class, and the  uncertainty of hislher diagnosis based on the TCM theory for  this class is less than the others'. Thus, the rules mined from  such doctors' diagnosing results are considered to be more  important than those mined from the other doctors'. Therefore,  the rules mined by different doctors' diagnosing results are  needed to integrate by increasing the weight of the rules which  are mined from the diagnosis information given by the doctor  whose diagnosis data induced the higher inference accuracy of     the corresponding class. Let the rule-set R? include all the  association rules which are mined from the diagnostic  information of ith doctor to the conclusion j. The conclusion  here means the sub-health state or the classes of TCM  Syndrome. Let PR, indicate the inference accuracy of R? J  calculated by the cross-validation. There are N doctors whose  diagnosis results were involved in the training data set. So, the  weight of the rule regarding the conclusion j mined from the  information given by the ith TCM doctor is given as the  following:  P . R'.

w, = }  j M  LPRk k=\ }  Rule-sets mined from different doctors'  (1)  diagnostic  information may get different results in the same input. And the  final deductive results are determined by the weighted sum of  each rule-set's. The final result is the conclusion that has the  maximum weighted sum. The individual differences of the  TCM doctors in diagnosing the sub-health state and the  different classes of the TCM syndrome are considered in the  rules mining by the rule integration.



V. EXPERIMENTS AND RESULTS  In the experiment, 16 subjects' information was collected  about 3 times once every two weeks by the method described  in the subsection 3.1. As a whole, there are 49 records in the  training data set. The score given by the TCM doctors is  assigned to one of 4 categories which are normality, slight  degree, middle degree, and serious degree according to the  values before the association rule mining. The samples with the  serious degree have not collected yet. For having a large  enough training data set, the data collection is continued now,  especially the samples of the subjects who appear the symptom  with the serious degree of sub-health.

The facial color features and the eyes' features are extracted  from the collected images. These features are incorporated with  the data of the corresponding feelings and physical status, and  the data of the sub-healthy state and their TCM syndrome  given by 3 TCM doctors. Then, 147 records in the data table  are prepared for the rule mining. The extracted features are  divided into some different intervals by CAlM. After the  association rule mining by CloudApriori algorithm, the  sub-healthy state or the each condition of the TCM syndrome  has about 110 candidate rules in the case that the conclusion is  regarded as each doctor's own diagnosis. Those candidate rules  are pruned and about 34 rules are left for the sub-healthy state  or each class of the TCM syndrome. The weight of the rule  regarding the conclusion j mined from the information given  by the ith TCM doctor is calculated for the rule integration  according to the equation (1).

The cross validation is used to verify the effectiveness of  the mined rules. When testing, the collected data set is divided  into six groups. Five of them are chosen as training data and  the rest one is used as the testing data. Results deduced from  the rules mined from the training data set are compared with  the conclusions of test data. The rate of the matching number  divided by the total number of the testing data set is defined as  the inference accuracy. The average accuracy is calculated by  10 cross validations in our experiments.

The inference accuracies of the association rules regarding  the sub-health and 13 classes of the TCM syndrome, which are  mined from the individual diagnosis results of 3 TCM doctors  are shown in Fig.5. The lines of blue withOmark, pink withD  mark, and orange withLimark indict the inference accuracy of  the rules mined from the diagnosing results of the TCM doctor  #1, #2 and #3 recorded in the training data set, respectively.

Such inference accuracy is called individual inference accuracy.

The line of green withOmark indicates the accuracies of the  rules that have been integrated. And the line of purple  with*mark indicates the accuracies of the non-integrated rules  which are mined from the average of the diagnostic  information of the three TCM doctors. Such inference accuracy  is called integrated inference accuracy.

-+-#1 doctor -+-#2 doctor ---lr-#3 doctor ?After rule integration ?After information combination  0.95  0.9 0.85  0.8 0.75  0.7 0.65  0.6 0.55  0.5 0.45  0.4 0.35  0.3 0.25  0.2 O. 15  0.1 0.05  Sub-hulth Cold Hol dtfidtnc:y st.cru.tion dtfidtnc:y stuis of dtfidtnc:y phltc .. and h.art lunc splttn livtr kidnty  of vital of vital of blood blood of jill. txc:usivt  tntrD'. tntrcy ?lui d  Figure 5. Inference accuracy  From Fig.5 we can see that all the 3 individual inference  accuracies of the sub-health state based on the diagnosis results  of the three TCM doctors are relatively close and high, and the  accuracy is up to 91% after the rule integration. That means  that the collected samples data providing to these doctors have  the complete information regarding the sub-health, so as to  they can give the perfect discrimination according to the  provided data, while such discriminations induce the above  high inference accuracies. Besides the sub-health, the  individual inference accuracies of the classes of Cold and  Kidney are also close and high, which induce the high  accuracies after the rule integration. However, for the other rest  classes, the individual inference accuracies based on the  diagnosis results of the different doctors are very different,  except the class of hot, for which the individual accuracies are  all low. It can be considered that the information providing to  the TCM doctors for diagnosing these classes is incomplete so  that the doctor who is not good at diagnosing these classes fails  to give the diagnosis results with the consistency. Accordingly,  the inference accuracy of the rules mined from such doctor's  diagnosis can not reach a high level. Only the rules mined from  the diagnosis results with the consistency can induce the high  inference accuracy. Therefore, in most cases, the inference  accuracies are improved by the rules integration compared with  the lowest ones, they can not be above the highest ones  achieved based on the individual TCM doctor's diagnosis.

Similarly, the results derived by the average of the diagnostic  information of the three TCM doctors, which are shown by the  plot with the line of purple with*mark in fig. 5, also confirms  the above statement.

Moreover, average accuracy of the rules deduced after rule  integration, is 52%. While the average accuracy of the rules  mined from the average diagnostic information of the doctors  is 47%. That is to say that the rule-set after integrating takes  more the individual difference of TCM doctors' experience  into account. It is expected that the more the doctors involved  in the data collection of the diagnosis, the higher the inference  accuracy can be achieved by the integrated rule sets. Of course,  involving many TCM doctors in the data collection is not an  actual approach. Therefore, selecting the rules that can induce  the highest inference accuracy among the rules mined from the  diagnosis results of some different TCM doctors as the final  association rules is a good idea.

It is also noticed that all the individual and integrated  inference accuracies of some classes of the TCM syndrome are  low, especially, the class of Hot. The reasons are supposed that  the samples collected for TCM doctors' diagnosing such  classes are very incomplete, or all the TCM doctors asked to do  the diagnosis are not good at diagnosing such classes. So,  collecting more samples and inviting more TCM doctors to  give the diagnosis results for the training data set will be our  next crucial work to improve the performance of the inference  model.



VI. CONCLUSION  This paper proposes a system framework that utilizes the  visual features of individuals and the information of their  feelings and physical status to infer their sub-health state and  the TCM syndrome automatically based on TCM doctors'  diagnosis knowledge, so as to help the users recuperating from  the sub-health by showing the corresponding regimen. For  realizing such a system, in this paper, the method of extracting  the features from the images of face and eyes is exploited.

Further, the data set composing of the subjects' images such as  face, eyes, tongue and so on, the scores of their feelings and  physical status, and the corresponding degrees of the subjects'  sub-healthy state and the TCM syndrome given by multiple  TCM doctors are collected for modeling the TCM doctors'  diagnosis. On the basis of the collected data set, the association  rules for inferring the objects' sub-health and physical status  are mined, while such rules integrate multiple TCM doctors'  diagnostic information which reflects the individual difference  of TCM doctors in diagnosis. The experiment shows that, after  the rule integration, the inference accuracy of the sub-health  is up to 91 %. However, the average inference accuracy of the  classes of the TCM syndrome is 52%, which needs to be  further improved by the way of colleting more samples and the  corresponding diagnostic information given by TCM doctors  and incorporating the knowledge of experts into the process of  the inference. On the other hand, it is expected to improve the  accuracy further by incorporating the features extracted from  the images of the tongue into the data set for mining the  association rules.

