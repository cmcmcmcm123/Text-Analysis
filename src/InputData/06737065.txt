Anamorphic Time Stretch Transform and its

Abstract?A method for compressing the time-bandwidth of  analog signals is introduced and demonstrated. As one of its  applications, this mathematical transformation performs feature-  selective time-stretch. When used as an analog pre-processor  before the digitizer, it enables capture of random signals that  would otherwise be beyond digitizer?s bandwidth. At the same  time, it compresses the digital data volume. Our method is loss-  less and does not require prior knowledge of the signal. It is  inspired by operation of Fovea centralis in human eye and by  anamorphic transformation in visual arts. Implemented in the  digital domain, the proposed transform also performs data and  image compression.

Index Terms? Anamorphic Stretch Transform; Warped Stretch  Transform, Photonic time stretch, Analog-to-Digital Converter;  Feature selective sampling; Same-domain transform; Warped  dispersive Fourier transform; Generalized Dispersive Fourier  Transform; Ambiguity function, Wigner distribution function;  Warped temporal imaging; Generalized wavelength-time mapping;  Time frequency distribution; image compression, big data.



I. INTRODUCTION  In conventional sampling, the analog signal is sampled at twice the highest frequency of the signal, the so-called Nyquist rate. This make inefficient use of the available samples because frequency components below the Nyquist rate are over sampled whereas frequency components above it are under sampled (see Fig. 1(a)). The problem arises because both sharp and coarse temporal features are sampled at the same rate. This causes two predicaments, (i) it limits the sharpest features that can be captured with a given sampling rate, and (ii) it results in a digital record length that is much larger than necessary (since coarse temporal features are over sampled).

Using Time Stretch Transform (TST) prior to sampling [1-4] the first problem is solved by reducing the signal bandwidth. In this method the stretch factor is the same for all temporal features so it does not solve the second problem.

Sharp temporal features are suitably slowed down for the digitizer to capture them but coarse features become over sampled. The over sampling of coarse temporal features results in the record length to be unnecessarily large.

Here we introduce a mathematical transform to address both problems. Implemented in analog domain prior to digitization, this same-domain transform compresses the signal bandwidth thus allowing a fast signal to be captured by a digitizer that would otherwise have insufficient bandwidth. At the same time, it results a shorter record length. Our technique is compared to the conventional sampling in Fig. 1(b).  Our technique performs selective sampling of different time features in contrast to frequency selective sampling.

Figure 1.  (a) In conventional sampling frequency components below  the Nyquist rate are over sampled whereas components above it, if  any, are under sampled. Here ?m is the modulation frequency. (b)  Comparison of conventional sampling (top) and proposed technique  for feature selective sampling (bottom). The Analog to Digital  Converter (ADC) has the same sampling rate in both cases. Through  analog transformation of the signal prior to sampling, the proposed  Anamorphic Stretch Transform (AST) leads to more efficient  utilization of the ADC?s finite sampling resource. Specifically, more  samples are allocated to sharp temporal features where they are  needed and fewer to coarse temporal features where they are  redundant. This compression of data is achieved without prior  knowledge of the input waveform and in an open-loop fashion.

While this paper focuses on applications in capturing ultrafast analog signals where the anamorphic transformation is performed in the analog domain, our mathematical transformation can also be performed in digital domain on digital data such as images. This all-digital implementation would be an image compression algorithm useful in dealing with the storage and transmission bottlenecks of ?big data?.

Analogy with Anamorphism in Graphic Arts  The warped stretch transformation evokes comparison to anamorphic images used to create optical illusion and art.

Fundamental differences exist between our technique and anamorphic optics. First, our technique warps the spectrum whereas in anamorphic optics the image is warped in its     original spatial domain. Second, the image transformation in anamorphic optics is arbitrary and is chosen for artistic considerations or to change the aspect ratio of the image. In contrast, in our technique the transformation causes feature- selective sampling without prior knowledge about the input waveform and in an open-loop fashion. Despite fundamental differences, because of the non-uniform warping of the signal in our technique, albeit executed in the frequency domain, we term our technique Anamorphic Stretch Transform (AST).



II. TECHNICAL DESCRIPTION  A pass-band analog signal can be represented by base-band waveform modulated on a carrier. Analog-to-Digital Converters (ADCs) digitize the modulation of input signal after down conversion to baseband or to a low intermediate frequency. Here we derive a mathematical algorithm that describes the optimum analog transformation that reshapes the spectrum of the electrical signal such that its modulation can be captured with an ADC that would otherwise be too slow.

Unlike the conventional uniform time stretch pre-processing [1], the new transformation also minimizes the record length and hence the data volume.

The transformation is implemented via a filter with engineered group delay (GD). Temporal group velocity dispersion can be represented by a filter with quadratic phase.

We generalize the problem by allowing the phase to be an arbitrary function of frequency (see Fig. 2(a)). H(?) is spectral response of a filter with spectral phase ?(?) and group delay of ?(?)=?[?(?)]/??. To process high speed electrical signals a wideband dispersive filter is required. Implementation of a wideband dispersive filter is more practical and less costly in the optical domain than in the electronic domain. To employ optical dispersive filters the input electrical signal must be first converted to the optical domain using a modulator. The input electrical signal is modulated on an optical carrier (i.e.

Continuous Wave (CW) light) using a modulator (see Fig. 2(a)). The resulting optical signal is then processed in the optical domain using the filter H(?) (optically dispersive element). If the input signal is optical to begin with, this modulation is not necessary.

The modulation intensity spectrum of the input signal can be described in terms of the complex amplitude Ei (t):  ( ) ( ){ }2FT? =i m iI E t                        (1) where  FT{}  is  the  Fourier  transform  and  ?m  is the modulation  (radial)  frequency.  It is easy to show that the modulation spectrum can be also shown as a correlation function:  ( ) ( ) ( )* , i m i i m  I E E d? ? ? ? ? ?  ?? = +? % %              (2)  where ( )iE ?%  is the field spectrum of the input electrical signal. The modulation spectrum of the output optical signal (i.e. after the optical filter), can be calculated as follow:    ( ) ( ) ( ) ( ) ( )( )* .? ? ? ? ?? ? ? ? ? ? ? +  ?? = +? % % m  j  o m i i m I E E e d  (3)   Figure 2. (a) The proposed anamorphic transformation is performed using a filter with a tailored frequency-dependent group delay placed prior to the analog-to-digital converter (ADC). Specifically, the input electrical signal is first converted to an optical signal using a modulator and then is processed in the optical domain using a filter with arbitrary group delay profile. The complex field of the transformed signal is measured and the input signal is reconstructed using back propagation. (b) An arbitrary input signal; inset shows its field spectrum. (c) The Modulation Intensity Distribution (MID) of the signal after it is subjected to a filter with S-shaped group delay (see inset of (c)). The MID is a 3D plot showing dependence of the intensity (color) on time and modulation frequency. For comparison, the MID of the input signal without the filter is shown in the inset. The anamorphic transform reduces the signal modulation bandwidth but it does not lead to a proportional increase in its time duration. The complex interference patterns arise because the system is in the near field. ?m=0 corresponds to the carrier frequency.

Here, we introduce the Anamorphic Stretch Transform (AST). It relates the input spectrum to output intensity spectrum [5]:  ( ){ }( )  ( ) ( ) ( ) ( )  *  AST  ,  ? ? ? ? ? ?  ?  ? ?  ? ? ? ?  ? ?+ ? ? ? ?? ??  ? ?  ?? = +?  %  % %  m m  m  i m  j  i i m  E  E E e d    (4)  The exponential kernel describes the impact of the filter on  the output intensity spectrum. For time-bandwidth     compression, the shape of the optimum group delay will be a  sublinear function resembling the letter ?S?. Therefore, one  may refer to this particular implementation as the S-Transform  (ST), although the Anamorphic Stretch Transform is more  general than this particular group delay function.

The transform, AST, gives the intensity spectrum at the output of the optical filter. Since our objective is to compress the modulation intensity bandwidth but also minimize the time duration, we require a mathematical tool that describes both the intensity spectrum and its temporal duration. The following 2D distribution describes the intensity spectrum and its dependence on time. We refer to this function as Modulation Intensity Distribution (MID):  ( ) ( ) *  MID( , )  ( ) ( ) .

? ? ? ? ? ?  ? ?  ?  ? ? ? ?  ? ?+ ? ? ? ?? ??  ? ?  ?? = +? % %  m m  m  m  j j t  i i m  t  E E e e d    (5)  The modulation spectrum and time duration of a signal subject to an arbitrary group delay is obtained from this 2D distribution. This information is then used to design the filter with the right group delay. MID can be described as the cross- correlation of the output signal spectrum with its temporally shifted waveform. The trajectory at t = 0 in the MID plot represents output intensity spectrum (see Fig. 2) and produces the transform AST. Also the absolute value of time shift (y- axis) over which cross-correlation has non-zero values is the time duration of the output signal (see Fig. 2).

The MID plot for an arbitrary signal (see Fig. 2(b)) subjected to a filter with an S-shaped GD (see inset of (c)) is shown in Fig. 2(c). The 3D plot shows the dependence of the modulation intensity (color) at the output on time and modulation frequency. The inset shows the same for the input signal. MID relates the bandwidth and temporal length of the envelope to the filter phase response (group delay profile). By choosing the proper filter, we can engineer the intensity bandwidth of the signal to match the sampling rate of the ADC and its time duration to minimize the number of samples needed to represent it. As an example, the horizontal arrow shows the intensity bandwidth and the vertical arrow designates the time duration. It should be mentioned that the output signal has both amplitude and phase information requiring complex- field detection. The time domain signal can then be reconstructed from the measured complex field. A number of complex field detection techniques can be employed here [6-8].

While filters with arbitrary group delay profiles can be considered for AST operation, here we are particularly interested in filters with general group delay profiles that compress the modulation time bandwidth product (TBP). As suggested by the MID plot in Fig. 2, such filters should have a sublinear group delay profile. The tan  -1 function provides a  simple mathematical description of such filters:  ( )1( ) tan ,? ? ??= ? ?A B                               (6)  where A and B are arbitrary real numbers. Using Eq. (6), a wide range of filter GD profiles can be generated requiring only two parameters to represent them. Parameter A in Eq. (6) is the amount of group delay dispersion and determines whether the filter is in the near field or far field regime. In the near field, A is on the order of the input signal duration, whereas in the far field, A is much larger than the duration. Parameter B is related to the degree of anamorphism.

We point out that no prior knowledge of the signal is necessary in our technique because the transform self-adapts to the contents of the signal. This self-adaptivity is a consequence of the frequency dependency in the transformation (see Eq. (4)). The optical filter with nonlinear group delay can be implemented with dispersive elements with engineered group velocity dispersion such as Chirped Fiber Bragg Gratings (CFBG), Chromo Modal Dispersion or free space gratings (see [5] for more information).



III. NUMERICAL RESULTS  As an example on how to engineer the modulation bandwidth and time duration of an electrical signal using MID and AST, we discuss the optimum group delay profile for an optical filter operating in the near field regime. Operating in the near field regime is especially important for  the  cases  where far  field regime cannot be achieved because of the limited bandwidth of the electrical signals (compared to the optical carrier) and insufficient available group delay. Because loss of optical devices increases with group delay, in many cases high losses do not allow to reach the far field.

In this example, the input electrical signal has modulation bandwidth of 40 GHz and ~6 ns time duration, see Fig. 3(a).

MID of the input signal is shown in the inset of Fig. 3(a). Our target is to compress the input electrical signal modulation bandwidth to 16 GHz, i.e. a compression factor of 2.5.

The filter transfer function is chosen such that for frequency components ranging from DC to 8 GHz a larger group delay is applied to higher frequencies than the case of linear group delay. The group delay for frequency components above 8 GHz is designed to be less than the case of linear group delay. This is because to achieve the same output modulation bandwidth, less group delay is required for fast features.

The left inset in Fig. 3(b) compares the nonlinear group delay used with a linear group delay that would have resulted in the same 16 GHz output modulation bandwidth. As seen in the right inset of Fig. 3(b), the modulation bandwidth is 16 GHz in both cases. However, the temporal duration (main curves in Fig. 3(b)) is ~13 ns vs. 20 ns, i.e. 35% reduction.

Figure 3(c) compares the MID plots for the case of linear group delay and the nonlinear group delay used here. These MID plots were used to design and analyze the optimized bandwidth compression system in this example. The complex interference patterns in MID plots arise because the system is operating in the near field. Experimental proof of time-bandwidth compression using the AST has recently been reported [5].

AST can be also applied in the digital domain to reduce the data size. To demonstrate this, we compared the performance of image compression using AST method, with standard JPEG compression. Results are shown in Fig. 4. The original gray scale  image  had  1000?1000  pixels  and  its  data  size  was       Figure 3.  Anamorphic transformation in the near field regime. (a)  Input electrical signal, and (b) comparison of the output optical signal  for optical filters with linear group delay (group delay) (solid blue  line) and with the tailored nonlinear group delay (dotted red line).

Left inset compares the group delay profiles of two systems and right  inset shows the output modulation spectrums. (c) Left and right  figures show the MID of input signal for optical filter with linear and  nonlinear group delay, respectively. In both cases the signal  modulation bandwidth is reduced from 40 GHz to 16 GHz, however  the temporal signal length, and hence the number of samples needed  to represent it, is nearly 35% lower with the anamorphic transform.

3.1 Mega Bytes (MB). The left column in Fig. 4 shows image compression using standard JPEG format with compression factor of 56. We then used AST to pre-compress the image before JPEG while maintaining the same total compression factor of 56. We also show zoomed in sections of the image for comparison. The results clearly show capability of the proposed AST for digital image compression.



IV. CONCLUSIONS  We introduced a new mathematical transform that can be used to compress the modulation time-bandwidth of signals.

This analog processing is performed prior to digitization and is aimed to overcome the bandwidth limitation of data converters, while at the same time reducing the digital data volume. The so called Anamorphic Stretch Transform (AST) can be employed to engineer the modulation bandwidth of an arbitrary waveform to match the sampling rate of the ADC while minimizing the number of samples needed to represent it. This transformation causes feature-selective stretching of the waveform. Once the warped waveform is uniformly sampled, more samples are    Figure 4. Performance of Anamorphic Stretch Transform (AST) for  image compression applications compared with JPEG. Left column:  compressed image using JPEG standard. Right column: compressed  image using AST+JPEG. Four parts of the images are magnified in  the underlying rows for comparison. In both cases the data size to  represent the original image is compressed by ~56 times, however  AST shows superior performance.

allocated to fast features where they are needed, and less to slow features where they are redundant. This compression of data is achieved without prior knowledge of the input waveform and in an open-loop fashion.

