Evaluating Topology-based Metrics for GO Term  Similarity Measures

Abstract ? Defining semantic functional similarity measures provides effective means to validate protein function prediction methods and to retrieve biologically relevant information from big biological data. It also improves understanding of inter- relationship between genes and gene products (GPs).

Currently, one of the most commonly used tools for functionally annotating genes and GPs is the Gene Ontology (GO), which describes genes/GPs using a machine-readable language. To measure the semantic similarity between two GO terms, many studies that are based on GO topology have recently been reported. However, a comprehensive assessment and general guidelines for validating these methods are lacking. In this paper, we collect a large dataset to evaluate five often-used semantic similarity measure methods by estimating sequence similarity, phylogenetic profile similarity, and structural similarity. We further compare the measures in terms of their clustering performance using domains extracted from SCOP database. We describe some key aspects of these measure methods and discuss how the limitations may be addressed as well as some open problems.

Keywords? semantic functional similarity; gene products; gene ontology;

I. INTRODUCTION Gene Ontology (GO) [1] is a structured vocabulary of biological terms and the de facto standard for genome annotation, which describes molecular function, biological process and cellular component of genes and gene products (GPs) in a species-independent manner. It has been widely used in gene function understanding, pathway analysis, and network modeling, among many others. GO functional terms are defined by several sources including wet- laboratory works; therefore, GO annotation implies integrative information of multiple data sources, which can be purified by controlling the hierarchal relations of terms and the GO evidence code. Furthermore, GO facilitates information exchanges between different biological communities by providing controlled vocabularies and uniform queries across them.

One of the most important tasks in GO-based applications is to understand functional similarities between two GO terms. In general, GO is structured as a directed acyclic graph (DAG), where each node represents a GO term and a directed edge starts from a parent node and ends at a child node. While GO can state that a child node has a  more specialized term than its parent nodes, it does not provide quantitative measures that reflect the similarities between any two GO terms. Quantitative similarity measure is important in many GO-based applications. For example, in protein function prediction [2-3], knowing the similarity between the predicted GO terms and true GO terms a protein possesses helps improve the assessment of various predictive models.

Figure 1. Overview of current similarity measuring methods   Current methods for term similarity measures are mostly based on the topology of the GO graph [4-7] and can be roughly grouped into four categories, as shown in Fig. 1.

The first group uses Information Content (IC) based on the number of GPs [8-11], which is calculated as the ratio between the number of GPs at root node (i.e. GO:0003674 in Fig. 1) and the number of GPs at Nearest Common Ancestor (NCA), the closest node from leaf nodes or the farthest node from the root node (i.e. the red rectangle in Fig. 1) shared by two target GO terms (i.e. two green rectangles in Fig. 1). The second group also employs IC, but methods in this group calculate IC from the number of GO terms, instead of using the number of annotated GPs [12].

The third group defines the term similarity by directly calculating the distance between two GO terms (with or without weights) [13]. The fourth group calculates functional similarity by normalizing the depth of NCA with the maximum depth of the entire GO graph [14].

While many approaches have been developed for GO term similarity measures, interestingly, contradicted performance has been reported in various studies [15-16],       which made it difficult for end users to choose metrics for their applications. Furthermore, lack of general guidelines for validating procedures impedes the fair comparisons among different methods. In this paper, we describe some evaluation guidelines that increase the intuitive interpretation of similarity scores through comprehensive evaluation processes. This includes comparisons of structure, phylogenetic profile and sequence similarities and biological/topological clusters. We compare five commonly used approaches for term similarity measures and discuss pitfalls and some open problems. In Section II, we detail the five methods. In Section III, comparison guidelines are discussed. Experimental results are presented in Section IV.

We discuss limitations of current methods and also open problems in Section V.



II. SIMILARITY MEASURE METHODS In this section, we introduce five methods for GO term similarity measures. Resnik?s method [9] uses information content of Nearest Common Ancestor (NCA), which is the closest node from leaf nodes or the farthest node from the root node shared by two GO terms, as the functional similarity of two GO terms. The final score is negative logarithm of the ratio between the number of annotated GPs corresponding to NCA of two GO terms goi and goj and total number of GPs associated with molecular function.

The equation is defined by   ( ) ( )( )  ( ) node   withassociated GPs of #  and of  withassociated GPs of #  Resnik  root gogoNCA  NCApwhere  NCApgogosim  ji  ji  =  ?= log,  (1)   Resnik?s similarity, simResnik, is nonnegative. Due to the unlimited maximum boundary, interpreting the significance of similarity scores is not easy. Therefore, the score is normalized between 0 and 1 by using maximum and minimum value of the observations, which is defined as follows:  ( ) ( ) ( ) ( ))(min)(max  )(min),( ,  ???  ?? =  simsim  simjisim jinorm GOGO  GOgogoGO gogoGO    where GOnorm denotes normalized GO term similarity and GOsim(?) represents all observed GO term similarities.

Schlicker et al. [10, 11] introduced relevance information by combining both Resnik and Lin?s [8] methods and the equation is defined by   ( ) ( ) ( ) ( ) ( ))(1loglog log2, NCAp  gopgop NCApgogosim  ji ji ??+  ? =Schlicker  (2)  where p(goi) is  the probability of the i-th GO term calculated by the number of annotated GPs for goi, and p(NCA) is the probability of the NCA of goi and goj. The score is designed to be decreased when p(NCA) is increased.

In other words, the final similarity score is rewarded or penalized based on the specificity of the NCA.

As an edge-based method, Jiang and Conrath?s method calculates semantic distances rather than similarities by combining distance of two GO terms and the density of parent terms in GO graph [13]. The equation of this method is shown below.

( ) ( )[ ]  ( )  ( ) ),()()( )( 1)(  )( )1(  ,  , ,min  pcTpICcIC pd pd  pE E  pcww where  wgogo  i  gogopathi iji  ji  diff  ????? ?  ? ?? ?  ? + ?? ? ?  ? ? ? ?  ? ?+=  =  = ? ?  ?  ??  Jiang  (3)  In this equation, wi denotes the weight of i-th edge, which is one of edges connecting two GO terms goi and goj with the shortest distance. The weight of each edges is defined between a child node and its direct parent node, w(c,p). E(p) denotes number of edges from a parent node to its direct child nodes and is called a density of parent node.

E denotes an average density in the entire GO graph. d(p) denotes depth of parent node and IC(c) and IC(p) are the information content (IC) at child node and parent node, respectively. T(c,p) is a link relation factor (i.e. ?is-a? and ?part-of? relation) and is set to one for all relations. ? and ? are parameters to control the significance between depth and density factors with the optimal values of 0.5 and 0.3, respectively, as suggested in the original paper.

To make diverse comparisons, methods using the probability of GO terms are also considered for evaluation.

Gentleman?s method [12], which is also known as simUI, uses number of GO terms, instead of number of GPs. simUL is defined as the ratio between the number of GO terms belonging to the path from root node to NCA |path(root, NCA)| and the number of GO terms resulted in the union of all nodes belonging to the path from root node to each of GO terms, goi and goj,|path(root, goi) ? path(root, goj) |.

( ) ( ) ( ) ( )jiji gorootpathgorootpath  NCArootpath gogosim  ,,  ,2 ,  ?  ? =UI  (4)   Finally, we consider Ye?s method [14], which focuses on the specificity of GO terms by directly adapting the relative depth of NCA into its similarity function.

( ) ( ) ( )[ ] ( )[ ] ( )[ ]???  ?? =  depthdepth depthNCAdepthgogosim ji minmax  min,Ye (5)   This is the normalized depth of NCA in terms of the maximum and minimum depth of the entire functional GO terms in the DAG.

Note that Eqs. 1-5 calculate similarity scores using the GO graph.  Resnik?s and Schlicker?s methods focus on the GO nodes, Ye?s and Gentleman?s scores emphasize edges,    and Jiang and Conrath?s method considers both nodes and edges. Next, we discuss approaches to evaluate the five methods.



III. EVALUATION METHODS To evaluate the performance of different metrics, we consider the use of the tendency of GP similarities in various forms. The hypothesis is that if genes or GPs are functionally similar, then the similarity calculated from baseline measurements including structure, sequence, and phylogenetic profiles will also show high similarities (to some degrees).

We construct a large dataset for evaluation purposes. To get the annotations of each gene/GP in SCOP, high-quality truly domain-centric GO annotations are downloaded from Superfamily DB (http://supfam.cs.bris.ac.uk) [17] and integrated into our local database for information retrieval.

Based on the annotation of SCOP domains at family level, a total of 2,690 unique domains are retrieved. Because 44 out of the 2,690 domains are annotated with non-existing GO terms in current GO, these domains are removed from the list. Finally a total number of 2,646 domains are obtained from SCOP, which lead to about 3.5 million unique domain pairs for further studies.

The evaluation criteria are derived from three categories: sequence, phylogenetic profile and structure similarities. Sequence similarity is often used for identifying the inheritance of homology [18]. Although several limitations have been reported [19-21], homologous proteins identified by sequence similarities are likely to share similar functions, i.e., sequence similarity and functional similarity are likely to be correlated. To get the sequence similarities, all SCOP domain sequences are downloaded from ASTRAL [22] (http://astral.berkeley.edu/), and sequence similarities of all possible pairs of domains are calculated by BLAST [23] (http://blast.ncbi.nlm.nih.gov) with default parameters.

The rational behind phylogenetic profiles is from the hypothesis that functionally linked proteins are evolved in a correlated fashion; therefore the homologs of functionally related proteins can be found in the same subset of organisms [24]. The phylogenetic profiles are created by checking whether the homologs of proteins are present or absent in the same organism. To create phylogenetic profiles, psiBLAST searches homologs of target proteins against proteins from 25 fully sequenced genomes with e- value less than 10-10. The similarity of phylogenetic profiles between domains is calculated by mutual information as shown in Eq. 6., where x and y denote two vectors of phylogenetic profiles associated with any pairs of two domains. p(x,y) is a joint probability of two domains derived from four possible states of occurrences in which zero states absence and one denotes presence. p(x) and p(y) are marginal probability describing the probability of absence and presence of corresponding domains.

MI x, y( ) = p x, y( ) ? log p x, y( )  p x( ) ? p y( )  ?  ? ? ?  ?  ? ? ?y=0   ? x=0   ?  where x ? x and y ? y  (6)  The third criterion we use is to measure the correlations between the similarity metrics and structure similarities.

This is based on the observations that knowledge of protein structures often provides a critical insight of protein functions. Indeed, protein structures are more conserved than sequences in evolutionary process [25]. This implies that the structural similarity has better characteristics to represent the functional relations between two proteins. To increase the relevance of measuring structural similarity, two different structural alignments are used: TM-align [26] and Dali [27]. Corresponding programs are downloaded from http://zhanglab.ccmb.med.umich.edu/TM-align/ and http://ekhidna.biocenter.helsinki.fi respectively.

Another criterion we use is clustering, which is utilized to measure the generalization capability of functional similarity measurement. The assumption is that if GPs having functionally close relations are projected into a network, then proteins categorized in similar functions should be closely located to each other in the network space.

To compare the clustering performances, all domain pairs (about 3.5 million) are used as our test data. The given dataset includes a total of 215 class families (CF), 266 super families (SF), and 393 families (FA). It is well known that proteins in SCOP classification at the superfamily level tend to have common evolutionary origins and functional features. Thus, they are more likely to have similar functions. In our study, we choose the family level, which is even more specific than superfamily level (i.e., it is highly likely that the targeted GPs in the same family will belong to the same functional group [28, 29]). Therefore, our clustering task is to group GPs of the same SCOP family into a cluster. We construct a similarity network with each node representing a SCOP domain and each edge denoting the strength of functional similarity. Edges with similarity scores less than a preset threshold will be removed. By varying the threshold values, the similarity network can reach either maximum number of clusters or highest precision (the ratio of the number of correctly identified edges to the total number of identified edges), depending on the tasks on hand.



IV. EXPERIMENTAL RESULTS In order to evaluate different methods, correlations between each method and four base line similarities are compared, which are shown in Fig. 2, where the averaged similarities of TM-alignment, DALI, Sequence, and Phylogenetic profile are described as TM, Dali, Seq, and Phy respectively.

Tendency curves by using matlab ?polyfit? function are drawn with solid lines and depicted as fitTM, fitDali, fitSeq, and fitPhy, corresponding to TM-alignment, DALI, Sequence, and Phylogenetic profile, respectively. As we can see that there is little correlation between Resnik?s, Gentlman?s, Jiangs metrics and sequence-, structure-, phylogenetic profile-based similarities. Schlicker?s metric correlates well with structure-based similarities when the degree of similarities is high (70% or higher). Overall, Ye?s method outperforms other methods and shows good    correlations with the sequence, phylogenetic profile, and structure similarities. Since Ye?s method simply uses the normalized depth of NCA as its similarity function, the results may suggest that relative depth in a GO DAG may provide better information for term similarities.

Alternatively, since node information may not be complete (e.g., unknown annotation for some gene products), the bias of node distributions may also contribute to the poor correlations shown with other methods. It is also worth mentioning that the correlation scores need not necessarily to be linear or propotional [30-33], however, if we test on a large dataset, the function similarities and sequence,  structure, phylogenetic profile similarities are expected to be related to some degrees, especially for these highly similar GPs. One issue with Ye?s method though, is that its similarity values are often smaller than these calculated from other methods. This happens because Ye?s score only considers NCA and in our studies, most NCAs are identified closer to root GO term. It causes a problem, namely shallow problem, where many GO term pairs have identical similarity scores (if they share the same NCA or their NCAs have the same depth). This issue has also been reported by other studies [8, 13].

0 0.2 0.4 0.6 0.8 1   0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9   Similarity from Resnik's method  S im  ila ri  ty     TM fitTM Dali fitDali Seq fitSeq Phy fitPhy     0 0.2 0.4 0.6 0.8 1   0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9   Smilarity from Schlicker's method  S im  ila ri  ty     TM fitTM Dali fitDali Seq fitSeq Phy fitPhy   0 0.2 0.4 0.6 0.8 1   0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9   Distance from Jiang's method  S im  ila ri  ty     TM fitTM DALI fitDALI SEQ fitSEQ PHY fitPHY    (a) (b) (c)  0 0.2 0.4 0.6 0.8 1  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9   Similarity from Gentleman's method  S im  ila ri  ty     TM fitTM Dali fitDali Seq fitSeq Phy fitPhy  0 0.2 0.4 0.6 0.8 1  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9   Similarity from Ye's method  S im  ila ri  ty     TM fitTM Dali fitDali Seq fitSeq Phy fitPhy     TM: similarity score from TM-align fitTM: fitted graph on TM data points  DALI: similarity score from DALI fitDALI: fitted graph on DALI data points  SEQ: pairwise sequence simialrity fitSEQ: fitted graph on SEQ data points  PHY: phylogenetic profile similarity fitPHY: fitted graph on PHY data points  (d) (e) (f)   Figure 2. Correlation measurements between the term similarities measures and sequence/phylogenetic profile/structure-based similarities    Figure 3. Maximum precision reached by each method    To compare the clustering performances, 2646 domains in SCOP databases are used as test data. There are 215, 266, and 393 clusters for class families (CF), super families (SF),  and families (FA), respectively. We compute the functional similarities of all possible combinations of SCOP domains.

A threshold of similarity scores for each method is adjusted until it reaches the best performance (either it has maximum number of clusters or highest average precision). Fig. 3 shows the maximum precisions that each method can reach with three different levels of domain families in SCOP classification. As can be seen, the maximum precisions are 100% for Ye?s method, and more than 90% for other methods except for Jiang?s method, for the three categories CF, SF, and FA. However, we also observed that the average number of clusters that Ye?s method can identify is much smaller than other methods as well as the true number of clusters, i.e., Ye?s method misses many true edges (e.g., GPs belong to the same family).



V. DISCUSSIONS AND CONCLUSIONS One of the observations is the poor correlations between the various metrics and sequence, structure, and phylogenetic profile based similarities, which may result from several issues.

Two well-documented issues are shadow and shallow problems. A shadow problem is one of the typical issues in similarity measures, which is caused by ignoring the details or fidelity of the target GO terms: terms located below a NCA will not contribute to similarity measures [4, 8]. A shallow problem is also reported as a significant defect in Jiang?s [13] and Lin?s [8] methods, which is caused by tendency of NCA location and the biased distributions of GPs. For example, when two sets of GO term pairs having same depth are considered, it is possible that the pair with a NCA near the root node has higher similarity score than the other pair with a NCA far away from the root node [16].

The incompleteness of current GO also causes problems: our knowledge about the roles of a gene or gene product in cellular life is still accumulating and evolving. Consequently, the terms and relations in GO are neither finite nor fully specified. Majority of the methods discussed here employ the information content (IC) as their major distributor to define functional similarity, which can be highly biased because of the incompleted genome and interest of studies particularly toward specific species and genomes. To make matters worse, the biased data do not necessarily guarantee to reflect the nature of gene or GPs. Therefore, IC may not be the best measure from biological point of view.

Besides the evolving characteristics of GO, two more problems should be considered when information theory is considered as significant contributor to define functional similarities: GPs with no annotation and root shared GO terms. When we first started the study, GO database released at April 2011 was used as our master database.  The database showed a total of 9833 functional GO terms, in which 820 terms were obsolete. Thus, we used 9013 GO terms. Due to the fact that most methods derived from information theory use IC to define functional similarity, it is interesting to see the distributions of GPs at individual GO terms. Surprisingly, we could not find any related studies on this issue. Although most studies use IC as a part of critical scoring functions, the fundamental sources of this score, i.e., the distributions of GPs, have not been reported yet. Simple statistics shows that 2479 GO terms out of 9013 GO terms do not have any associated GPs, which means that only 6534 GO terms are actually meaningful in IC-based methods. Furthermore, more than half of meaningful GO terms have less than 50 GPs, many of them with less than five annotated GPs.  Accordingly, the IC-based methods are limited by GO terms without annotated GPs and with few annotated GPs.

Herein root shared GO terms refer to GO terms with a NCA that is the root node. We call this problem as nil functional similarity problems because for most current methods no functional similarity is defined. We searched all possible GO term pairs and found that 52% of GO term pairs have root node as their NCAs, i.e. methods derived from IC and NCA-based methods cannot distinct the differences of GO terms or can mislead the results for more than half of all  possible GO term pairs. To find out the biological relevance of using IC and NCA-based methods, we conduct the following experiment: protein-protein interaction (PPI) pairs associated with root shared GO terms are investigated from our KUPS database [35], which contains manually curated PPIs retrieved from IntAct, MINT, and HPRD. We report an interesting finding here. The example is about ribonuclease III activity (GO:0004525) and metal ion binding (GO:0046872), which are shared by root-node molecular function (GO:0003674).

We retrieved 53 GPs from UniProt, which contain both GO:0004525 and GO0046872. These GPs are all associated with ?dicer-like endoribonuclease? proteins that cleave the phosphodiester bond within a polynucleotide chain and lead double-stranded RNA (dsRNA) and pre-microRNA (miRNA) into short double-stranded RNA fragments called small interfering RNA (siRNA). As expected from their names, these enzymes share enzyme code (EC), 3.1.26.- which corresponds to ?ribonuclease?. They also share a cofactor ?magnesium or manganese?. Apparently, GO:0004525 and GO:0046872 are highly related and should not be considered as nil functional similarity. Therefore, IC and NCA-based methods, which always treat root-shared GO terms equally, are limited in identifying groups of GPs that are functionally similar and have the root node as their NCA.

In conclusion, while GO DAG is informative for annotating gene/GPs, measuring GO term similarities by using GO structure alone may be limited as we show in this paper.

Several problems exist such as the evolving nature of GO and the nil functional similarities. The lack of strong correlations between current methods and sequence, structure, phylogenetic profile based similarities clearly demands new metrics for term similarity measures. One future direction is to integrate both the GO graph and existing biological knowledge into one single scoring metric. For example, RNA- Seq and protein structure data may provide direct evidence of similarity between two GPs and are complementary to information extracted from GO.

